{
  "hash": "86d8d891ddde281fb8354471219faef4",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Pilot Retention Subfactor Analysis\"\nsubtitle: \"Phase 1A: Within-Construct Sub-Item Rankings and Demographic Comparisons\"\nauthor: \"Analysis Team\"\ndate: today\nformat:\n  docx:\n    toc: true\n    number-sections: true\n  html:\n    toc: true\n    toc-depth: 3\n    code-fold: true\n    embed-resources: true\n    theme: cosmo\n    number-sections: true\nexecute:\n  warning: false\n  message: false\n  echo: true\n---\n\n# Overview\n\nThis analysis examines the 31 sub-item rankings within each retention construct and compares them across demographics.\n\n# Setup\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(rstatix)\nlibrary(knitr)\nlibrary(janitor)\nlibrary(DescTools)\n\noptions(scipen = 999)\nknitr::opts_chunk$set(fig.width = 10, fig.height = 6)\n\n# Create output directories\ndir.create(\"../../output/tables/subfactor_analysis\", showWarnings = FALSE, recursive = TRUE)\ndir.create(\"../../output/figures/subfactor_analysis\", showWarnings = FALSE, recursive = TRUE)\n\n# Helper function to safely run Mann-Whitney U tests with effect sizes\nsafe_wilcox_test <- function(data, formula, exact = FALSE) {\n  # Check if we have at least 2 groups with data\n  group_var <- all.vars(formula)[2]\n  n_groups <- data %>%\n    filter(!is.na(!!sym(group_var))) %>%\n    pull(!!sym(group_var)) %>%\n    n_distinct()\n\n  if (n_groups < 2) {\n    # Return empty result if not enough groups\n    return(tibble(\n      .y. = character(),\n      group1 = character(),\n      group2 = character(),\n      n1 = integer(),\n      n2 = integer(),\n      statistic = numeric(),\n      p = numeric(),\n      effsize = numeric(),\n      magnitude = character()\n    ))\n  }\n\n  # Run the test (this should succeed for all valid items)\n  test_result <- tryCatch({\n    wilcox_test(data, formula, exact = exact)\n  },\n  error = function(e) {\n    # Return empty on test failure\n    return(tibble(\n      .y. = character(),\n      group1 = character(),\n      group2 = character(),\n      n1 = integer(),\n      n2 = integer(),\n      statistic = numeric(),\n      p = numeric()\n    ))\n  })\n\n  # If test failed, return empty\n  if (nrow(test_result) == 0) {\n    return(tibble(\n      .y. = character(),\n      group1 = character(),\n      group2 = character(),\n      n1 = integer(),\n      n2 = integer(),\n      statistic = numeric(),\n      p = numeric(),\n      effsize = numeric(),\n      magnitude = character()\n    ))\n  }\n\n  # Try to compute effect sizes (may fail for sparse items)\n  effsize_result <- tryCatch({\n    wilcox_effsize(data, formula)\n  },\n  error = function(e) {\n    # Return NA effect sizes for items that fail\n    test_result %>%\n      select(item, .y.) %>%\n      distinct() %>%\n      mutate(\n        effsize = NA_real_,\n        magnitude = NA_character_\n      )\n  })\n\n  # Combine results with proper join (include item to avoid cross-product)\n  test_result %>%\n    left_join(\n      effsize_result %>% select(item, .y., effsize, magnitude),\n      by = c(\"item\", \".y.\")\n    )\n}\n\n# Helper function to safely run Kruskal-Wallis tests with effect sizes\nsafe_kruskal_test <- function(data, formula) {\n  # Check if we have at least 2 groups with data\n  group_var <- all.vars(formula)[2]\n  n_groups <- data %>%\n    filter(!is.na(!!sym(group_var))) %>%\n    pull(!!sym(group_var)) %>%\n    n_distinct()\n\n  if (n_groups < 2) {\n    # Return empty result if not enough groups\n    return(tibble(\n      .y. = character(),\n      n = integer(),\n      statistic = numeric(),\n      df = integer(),\n      p = numeric(),\n      effsize = numeric(),\n      magnitude = character()\n    ))\n  }\n\n  # Run the test (this should succeed for all valid items)\n  test_result <- tryCatch({\n    kruskal_test(data, formula)\n  },\n  error = function(e) {\n    # Return empty on test failure\n    return(tibble(\n      .y. = character(),\n      n = integer(),\n      statistic = numeric(),\n      df = integer(),\n      p = numeric()\n    ))\n  })\n\n  # If test failed, return empty\n  if (nrow(test_result) == 0) {\n    return(tibble(\n      .y. = character(),\n      n = integer(),\n      statistic = numeric(),\n      df = integer(),\n      p = numeric(),\n      effsize = numeric(),\n      magnitude = character()\n    ))\n  }\n\n  # Try to compute effect sizes (may fail for sparse items)\n  effsize_result <- tryCatch({\n    kruskal_effsize(data, formula)\n  },\n  error = function(e) {\n    # Return NA effect sizes for items that fail\n    test_result %>%\n      select(item, .y.) %>%\n      distinct() %>%\n      mutate(\n        effsize = NA_real_,\n        magnitude = NA_character_\n      )\n  })\n\n  # Combine results with proper join (include item to avoid cross-product)\n  test_result %>%\n    left_join(\n      effsize_result %>% select(item, .y., effsize, magnitude),\n      by = c(\"item\", \".y.\")\n    )\n}\n\n# Variable labels from survey instrument\nfinancial_labels <- c(\n  \"financial_1\" = \"Competitive salary\",\n  \"financial_2\" = \"Allowances and soft pay\",\n  \"financial_3\" = \"Benefits package\",\n  \"financial_4\" = \"Disability insurance\",\n  \"financial_5\" = \"Job security\",\n  \"financial_6\" = \"New hire/longevity bonuses\"\n)\n\nqol_labels <- c(\n  \"qo_l_1\" = \"Predictable schedule\",\n  \"qo_l_2\" = \"Vacation time\",\n  \"qo_l_3\" = \"Family-friendly policies\",\n  \"qo_l_4\" = \"Home base possibility\",\n  \"qo_l_5\" = \"Travel benefits\",\n  \"qo_l_6\" = \"Work-life balance\"\n)\n\nprofessional_labels <- c(\n  \"professional_1\" = \"Financially stable airline\",\n  \"professional_2\" = \"Rapid upgrade opportunity\",\n  \"professional_3\" = \"Fly larger aircraft\",\n  \"professional_4\" = \"Merit-based promotion\",\n  \"professional_5\" = \"Seniority-based upgrade\"\n)\n\nrecognition_labels <- c(\n  \"recognition_1\" = \"Professional uniforms\",\n  \"recognition_3\" = \"Vacation for long service\",\n  \"recognition_4\" = \"Professional respect/recognition\",\n  \"recognition_7\" = \"Airline recognition\"\n)\n\nschedule_labels <- c(\n  \"schedule_1\" = \"Fixed schedule\",\n  \"schedule_2\" = \"Variable schedule\",\n  \"schedule_3\" = \"Flexible work rules\",\n  \"schedule_4\" = \"Bid line seniority system\",\n  \"schedule_5\" = \"Vacation bidding rules\"\n)\n\noperational_labels <- c(\n  \"operational_1\" = \"Unambiguous SOPs\",\n  \"operational_2\" = \"Proactive training\",\n  \"operational_3\" = \"Well-maintained aircraft\",\n  \"operational_4\" = \"Well-equipped aircraft\",\n  \"operational_5\" = \"Highly skilled pilots\"\n)\n```\n:::\n\n\n# Data Loading\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load data (same as retention.Rmd)\nraw <- read_csv(\"../../data/processed/retention.csv\", show_col_types = FALSE)\n\nretention_data <- raw %>%\n  slice(-(1:2)) %>%\n  clean_names()\n\n# Filter to valid responses\nincluded_data <- retention_data %>%\n  mutate(\n    finished = toupper(as.character(finished)),\n    informed_consent = toupper(as.character(informed_consent)),\n    screener = toupper(as.character(screener))\n  ) %>%\n  filter(\n    finished == \"TRUE\",\n    informed_consent == \"YES\",\n    screener == \"YES\"\n  )\n\ncat(\"Valid observations:\", nrow(included_data), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nValid observations: 76 \n```\n\n\n:::\n:::\n\n\n# Demographic Groups\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create demographic groups (matching retention.Rmd approach)\nincluded_data <- included_data %>%\n  mutate(\n    # Numeric conversions\n    age = as.numeric(age),\n    experience = as.numeric(experience),\n\n    # Age groups\n    age_group = if_else(age <= 35, \"≤35\", \">35\"),\n\n    # Experience quartiles\n    exp_q = ntile(experience, 4),\n    exp_q = factor(exp_q, labels = c(\"Q1\", \"Q2\", \"Q3\", \"Q4\")),\n\n    # Gender\n    gender_clean = case_when(\n      tolower(gender) %in% c(\"male\", \"m\") ~ \"Male\",\n      tolower(gender) %in% c(\"female\", \"f\") ~ \"Female\",\n      TRUE ~ NA_character_\n    ),\n\n    # Position\n    position = position_position,\n\n    # Military\n    military_clean = case_when(\n      str_detect(tolower(military_experience), \"currently serve|previously served\") ~ \"Military\",\n      str_detect(tolower(military_experience), \"never\") ~ \"Civilian\",\n      TRUE ~ NA_character_\n    )\n  )\n\n# Summary\ncat(\"\\n=== DEMOGRAPHICS ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== DEMOGRAPHICS ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Age groups:\\n\"); table(included_data$age_group) %>% print()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAge groups:\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n>35 ≤35 \n 18  58 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\nGender:\\n\"); table(included_data$gender_clean, useNA = \"ifany\") %>% print()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nGender:\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nFemale   Male   <NA> \n     8     67      1 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\nPosition:\\n\"); table(included_data$position, useNA = \"ifany\") %>% print()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nPosition:\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n      Captain First Officer \n           26            50 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\nExperience:\\n\"); table(included_data$exp_q) %>% print()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nExperience:\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nQ1 Q2 Q3 Q4 \n19 19 19 19 \n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\nMilitary:\\n\"); table(included_data$military_clean, useNA = \"ifany\") %>% print()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nMilitary:\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCivilian Military \n      69        7 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Sample characteristics:\n# Total valid responses: n=76\n# Demographic splits reflect regional airline pilot population:\n#   - Gender: ~11% female (8-12% is typical for regional carriers)\n#   - Age: Cutoff at 35 chosen as average age of first-year FOs at legacy/major carriers\n#   - Experience: Pilots divided into quartiles based on total flight hours\n# Cohen's guidelines suggest minimum n≥15 per group for adequate power.\n# Results for gender comparisons should be interpreted with caution due to\n# insufficient statistical power to detect small-to-moderate effects.\n# The \"no significant differences\" finding may reflect inadequate power rather\n# than true absence of differences.\n```\n:::\n\n\n# Statistical Methods\n\n## Multiple Testing Correction Approach\n\nThis exploratory pilot study employs a **two-step hierarchical false discovery rate (FDR) control procedure** appropriate for the study's structure (6 constructs × 5 demographics = 155 tests) and exploratory aims.\n\n**Step 1 - Construct-Level Screening:**\nFor each of the six retention constructs (Financial, Quality of Life, Professional, Recognition, Schedule, Operational), we compute the minimum p-value across all five demographic comparisons (age, gender, position, military experience, experience level). These six screening p-values are adjusted using the Benjamini-Hochberg (BH) procedure at false discovery rate q=0.10.\n\n**Step 2 - Detailed Testing Within Significant Constructs:**\nFor constructs that pass screening (p_adj < 0.10), individual demographic comparisons within that construct are adjusted using Holm's sequentially rejective procedure at α=0.05. Each construct's demographic comparisons are treated as an independent family, controlling the family-wise error rate (FWER) within that construct.\n\n**Rationale:**\nStandard Bonferroni correction (α = 0.05/155 ≈ 0.0003) is inappropriately conservative for exploratory research, creating Type II error rates of 50-70% and missing genuine effects that warrant follow-up investigation. FDR control at q=0.10 accepts that approximately 10% of significant findings may be false discoveries, but ensures we do not miss the 90% that represent true demographic differences. This approach balances error types appropriately for hypothesis generation in pilot research with small samples (n=76).\n\nThe hierarchical structure exploits the logical grouping of tests (subfactors within constructs) to increase statistical power compared to flat correction across all 155 tests simultaneously.\n\n**Within-Subjects Comparisons:**\nFriedman tests assess whether subfactor rankings differ within each construct. Post-hoc pairwise comparisons (if needed) use Wilcoxon signed-rank tests with Holm correction (not BH-FDR, as these repeated-measures comparisons are strongly dependent), treating each construct's comparisons as a separate family.\n\n**References:**\nBenjamini & Hochberg (1995) J Royal Statistical Society B; Li & Ghosh (2014) BMC Bioinformatics; Armstrong (2014) Ophthalmic & Physiological Optics; Bender & Lange (1999) BMJ.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Construct-Level Screening with Benjamini-Hochberg FDR\n# ========================================================\n# Step 1 of hierarchical testing: Determine which constructs show\n# demographic differences at construct level before examining individual subfactors.\n#\n# Method: For each construct, compute minimum p-value across all demographic\n# comparisons (age, gender, position, military, experience). Apply BH-FDR at q=0.10\n# to these 6 screening p-values.\n#\n# Rationale: Exploratory pilot research (n=76) requires balance between Type I and\n# Type II error control. Bonferroni (α=0.0003 per test) is too conservative and\n# causes 50-70% Type II error rate, missing genuine effects. BH-FDR at q=0.10\n# controls false discovery rate (expected proportion of false positives among\n# significant results) while maintaining adequate power for hypothesis generation.\n\ncat(\"\\n=== CONSTRUCT-LEVEL SCREENING ===\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== CONSTRUCT-LEVEL SCREENING ===\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Testing whether each construct shows demographic differences\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nTesting whether each construct shows demographic differences\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"Method: Benjamini-Hochberg FDR at q=0.10\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nMethod: Benjamini-Hochberg FDR at q=0.10\n```\n\n\n:::\n\n```{.r .cell-code}\n# CRITICAL: Declare screening_results tibble BEFORE any construct sections\n# This tibble will be populated after each construct completes its demographic analyses\nscreening_results <- tibble(\n  construct = character(),\n  min_p = numeric(),\n  n_subfactors = integer()\n)\n\n# Note: Each construct section will append one row to this tibble\n# After all 6 constructs complete, we'll apply BH-FDR to these 6 p-values\n```\n:::\n\n\n# Financial Subfactors\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncat(\"\\n========================================\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n========================================\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"FINANCIAL SUBFACTORS\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nFINANCIAL SUBFACTORS\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"========================================\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n========================================\n```\n\n\n:::\n\n```{.r .cell-code}\n# Convert to long format\nfinancial_long <- included_data %>%\n  select(age_group, gender_clean, position, exp_q, military_clean,\n         financial_1:financial_6) %>%\n  mutate(respondent_id = row_number()) %>%  # Create persistent ID before pivoting\n  mutate(across(financial_1:financial_6, as.numeric)) %>%\n  pivot_longer(\n    cols = financial_1:financial_6,\n    names_to = \"item\",\n    values_to = \"rank\"\n  ) %>%\n  filter(!is.na(rank))\n\n# Descriptive stats\nfinancial_desc <- financial_long %>%\n  group_by(item) %>%\n  summarise(\n    n = n(),\n    median = median(rank),\n    mean = mean(rank),\n    sd = sd(rank),\n    pct_rank1 = sum(rank == 1) / n() * 100\n  ) %>%\n  mutate(item = recode(item, !!!financial_labels))\n\nkable(financial_desc, digits = 2, caption = \"Financial Subfactors - Descriptive Statistics\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Financial Subfactors - Descriptive Statistics\n\n|item                       |  n| median| mean|   sd| pct_rank1|\n|:--------------------------|--:|------:|----:|----:|---------:|\n|Competitive salary         | 76|    2.0| 1.64| 0.74|     47.37|\n|Allowances and soft pay    | 76|    4.0| 3.96| 1.24|      1.32|\n|Benefits package           | 76|    3.0| 3.36| 1.14|      5.26|\n|Disability insurance       | 76|    4.5| 4.41| 1.05|      1.32|\n|Job security               | 76|    2.0| 2.09| 1.28|     44.74|\n|New hire/longevity bonuses | 76|    6.0| 5.54| 0.92|      0.00|\n\n\n:::\n\n```{.r .cell-code}\n# Friedman test\nfriedman_financial <- financial_long %>%\n  friedman_test(rank ~ item | respondent_id)\n\nkable(friedman_financial, digits = 3, caption = \"Financial: Friedman Test (Within-Construct Comparison)\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Financial: Friedman Test (Within-Construct Comparison)\n\n|.y.  |  n| statistic| df|  p|method        |\n|:----|--:|---------:|--:|--:|:-------------|\n|rank | 76|    231.06|  5|  0|Friedman test |\n\n\n:::\n\n```{.r .cell-code}\n# Median rank visualization\nfinancial_plot <- financial_desc %>%\n  mutate(item = fct_reorder(item, desc(median))) %>%\n  ggplot(aes(x = median, y = item)) +\n  geom_col(fill = \"steelblue\", alpha = 0.8) +\n  geom_text(aes(label = sprintf(\"%.1f\", median)), hjust = -0.2, size = 3) +\n  labs(\n    title = \"Financial Subfactor Priorities\",\n    subtitle = \"Median rank (lower = higher priority)\",\n    x = \"Median Rank\",\n    y = NULL\n  ) +\n  theme_minimal() +\n  theme(plot.title = element_text(face = \"bold\"))\n\nprint(financial_plot)\n```\n\n::: {.cell-output-display}\n![](subfactor_analysis_files/figure-docx/financial-1.png)\n:::\n\n```{.r .cell-code}\nggsave(\"../../output/figures/subfactor_analysis/financial_median_ranks.png\",\n       financial_plot, width = 8, height = 5, dpi = 300)\n\n# Age group comparisons (Mann-Whitney U)\nmw_age_fin <- financial_long %>%\n  filter(!is.na(age_group)) %>%\n  group_by(item) %>%\n  safe_wilcox_test(rank ~ age_group, exact = FALSE) %>%\n  ungroup()\n\nif (nrow(mw_age_fin) > 0) {\n  mw_age_fin <- mw_age_fin %>%\n    mutate(p_raw = p) %>%  # Preserve raw p-value (p column still exists)\n    adjust_pvalue(method = \"holm\") %>%  # Operates on existing 'p' column, creates 'p.adj'\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%  # Final renaming: p_raw→p, p.adj→p_adj_holm\n    mutate(item = recode(item, !!!financial_labels))\n}\n\nkable(mw_age_fin, digits = 3, caption = \"Financial: Age Group Comparisons (Mann-Whitney U)\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Financial: Age Group Comparisons (Mann-Whitney U)\n\n|item                       | statistic|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:--------------------------|---------:|-----:|----------:|:------------|-------:|:---------|\n|Competitive salary         |     460.5| 0.406|      1.000|ns           |   0.096|small     |\n|Allowances and soft pay    |     502.0| 0.806|      1.000|ns           |   0.029|small     |\n|Benefits package           |     583.0| 0.444|      1.000|ns           |   0.088|small     |\n|Disability insurance       |     515.0| 0.934|      1.000|ns           |   0.010|small     |\n|Job security               |     516.5| 0.948|      1.000|ns           |   0.008|small     |\n|New hire/longevity bonuses |     619.0| 0.127|      0.762|ns           |   0.176|small     |\n\n\n:::\n\n```{.r .cell-code}\n# Gender comparisons\nmw_gender_fin <- financial_long %>%\n  filter(!is.na(gender_clean)) %>%\n  group_by(item) %>%\n  safe_wilcox_test(rank ~ gender_clean, exact = FALSE) %>%\n  ungroup()\n\nif (nrow(mw_gender_fin) > 0) {\n  mw_gender_fin <- mw_gender_fin %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!financial_labels))\n}\n\nkable(mw_gender_fin, digits = 3, caption = \"Financial: Gender Comparisons (Mann-Whitney U)\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Financial: Gender Comparisons (Mann-Whitney U)\n\n|item                       | statistic|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:--------------------------|---------:|-----:|----------:|:------------|-------:|:---------|\n|Competitive salary         |     363.0| 0.069|      0.415|ns           |   0.211|small     |\n|Allowances and soft pay    |     332.5| 0.258|      1.000|ns           |   0.132|small     |\n|Benefits package           |     204.0| 0.259|      1.000|ns           |   0.131|small     |\n|Disability insurance       |     174.0| 0.093|      0.464|ns           |   0.195|small     |\n|Job security               |     205.0| 0.255|      1.000|ns           |   0.133|small     |\n|New hire/longevity bonuses |     311.0| 0.339|      1.000|ns           |   0.112|small     |\n\n\n:::\n\n```{.r .cell-code}\n# Position comparisons\nmw_position_fin <- financial_long %>%\n  filter(!is.na(position)) %>%\n  group_by(item) %>%\n  safe_wilcox_test(rank ~ position, exact = FALSE) %>%\n  ungroup()\n\nif (nrow(mw_position_fin) > 0) {\n  mw_position_fin <- mw_position_fin %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!financial_labels))\n}\n\nkable(mw_position_fin, digits = 3, caption = \"Financial: Position Comparisons (Mann-Whitney U)\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Financial: Position Comparisons (Mann-Whitney U)\n\n|item                       | statistic|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:--------------------------|---------:|-----:|----------:|:------------|-------:|:---------|\n|Competitive salary         |     603.5| 0.574|      1.000|ns           |   0.065|small     |\n|Allowances and soft pay    |     596.0| 0.547|      1.000|ns           |   0.070|small     |\n|Benefits package           |     646.5| 0.973|      1.000|ns           |   0.005|small     |\n|Disability insurance       |     730.0| 0.362|      1.000|ns           |   0.105|small     |\n|Job security               |     674.5| 0.781|      1.000|ns           |   0.033|small     |\n|New hire/longevity bonuses |     755.5| 0.137|      0.822|ns           |   0.171|small     |\n\n\n:::\n\n```{.r .cell-code}\n# Military comparisons\nmw_military_fin <- financial_long %>%\n  filter(!is.na(military_clean)) %>%\n  group_by(item) %>%\n  safe_wilcox_test(rank ~ military_clean, exact = FALSE) %>%\n  ungroup()\n\nif (nrow(mw_military_fin) > 0) {\n  mw_military_fin <- mw_military_fin %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!financial_labels))\n}\n\nkable(mw_military_fin, digits = 3, caption = \"Financial: Military Comparisons (Mann-Whitney U)\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Financial: Military Comparisons (Mann-Whitney U)\n\n|item                       | statistic|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:--------------------------|---------:|-----:|----------:|:------------|-------:|:---------|\n|Competitive salary         |     311.5| 0.164|      0.984|ns           |   0.161|small     |\n|Allowances and soft pay    |     233.5| 0.890|      1.000|ns           |   0.017|small     |\n|Benefits package           |     264.5| 0.676|      1.000|ns           |   0.049|small     |\n|Disability insurance       |     229.0| 0.821|      1.000|ns           |   0.027|small     |\n|Job security               |     169.5| 0.173|      0.984|ns           |   0.157|small     |\n|New hire/longevity bonuses |     246.0| 0.926|      1.000|ns           |   0.012|small     |\n\n\n:::\n\n```{.r .cell-code}\n# Experience quartile comparisons (Kruskal-Wallis)\nkw_exp_fin <- financial_long %>%\n  filter(!is.na(exp_q)) %>%\n  group_by(item) %>%\n  safe_kruskal_test(rank ~ exp_q) %>%\n  ungroup()\n\nif (nrow(kw_exp_fin) > 0) {\n  kw_exp_fin <- kw_exp_fin %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, df, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!financial_labels))\n}\n\nkable(kw_exp_fin, digits = 3, caption = \"Financial: Experience Comparisons (Kruskal-Wallis)\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Financial: Experience Comparisons (Kruskal-Wallis)\n\n|item                       | statistic| df|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:--------------------------|---------:|--:|-----:|----------:|:------------|-------:|:---------|\n|Competitive salary         |     1.885|  3| 0.597|          1|ns           |  -0.015|small     |\n|Allowances and soft pay    |     3.862|  3| 0.277|          1|ns           |   0.012|small     |\n|Benefits package           |     3.708|  3| 0.295|          1|ns           |   0.010|small     |\n|Disability insurance       |     4.724|  3| 0.193|          1|ns           |   0.024|small     |\n|Job security               |     2.263|  3| 0.520|          1|ns           |  -0.010|small     |\n|New hire/longevity bonuses |     4.884|  3| 0.181|          1|ns           |   0.026|small     |\n\n\n:::\n\n```{.r .cell-code}\n# Save tables to CSV\nwrite_csv(financial_desc, \"../../output/tables/subfactor_analysis/financial_descriptive.csv\")\nwrite_csv(friedman_financial, \"../../output/tables/subfactor_analysis/financial_friedman.csv\")\nif (nrow(mw_age_fin) > 0) write_csv(mw_age_fin, \"../../output/tables/subfactor_analysis/financial_age.csv\")\nif (nrow(mw_gender_fin) > 0) write_csv(mw_gender_fin, \"../../output/tables/subfactor_analysis/financial_gender.csv\")\nif (nrow(mw_position_fin) > 0) write_csv(mw_position_fin, \"../../output/tables/subfactor_analysis/financial_position.csv\")\nif (nrow(mw_military_fin) > 0) write_csv(mw_military_fin, \"../../output/tables/subfactor_analysis/financial_military.csv\")\nif (nrow(kw_exp_fin) > 0) write_csv(kw_exp_fin, \"../../output/tables/subfactor_analysis/financial_experience.csv\")\n\n# Collect minimum p-value for screening\nmin_p_financial <- min(\n  if(nrow(mw_age_fin) > 0) min(mw_age_fin$p) else 1,\n  if(nrow(mw_gender_fin) > 0) min(mw_gender_fin$p) else 1,\n  if(nrow(mw_position_fin) > 0) min(mw_position_fin$p) else 1,\n  if(nrow(mw_military_fin) > 0) min(mw_military_fin$p) else 1,\n  if(nrow(kw_exp_fin) > 0) min(kw_exp_fin$p) else 1\n)\n\nscreening_results <- screening_results %>%\n  add_row(\n    construct = \"Financial\",\n    min_p = min_p_financial,\n    n_subfactors = 6\n  )\n\ncat(\"Financial screening p-value:\", round(min_p_financial, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nFinancial screening p-value: 0.0691 \n```\n\n\n:::\n:::\n\n\n# Quality of Life Subfactors\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncat(\"\\n========================================\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n========================================\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"QUALITY OF LIFE SUBFACTORS\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nQUALITY OF LIFE SUBFACTORS\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"========================================\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n========================================\n```\n\n\n:::\n\n```{.r .cell-code}\n# Convert to long format\nqol_long <- included_data %>%\n  select(age_group, gender_clean, position, exp_q, military_clean,\n         qo_l_1:qo_l_6) %>%\n  mutate(respondent_id = row_number()) %>%  # Create persistent ID before pivoting\n  mutate(across(qo_l_1:qo_l_6, as.numeric)) %>%\n  pivot_longer(\n    cols = qo_l_1:qo_l_6,\n    names_to = \"item\",\n    values_to = \"rank\"\n  ) %>%\n  filter(!is.na(rank))\n\n# Descriptive stats\nqol_desc <- qol_long %>%\n  group_by(item) %>%\n  summarise(\n    n = n(),\n    median = median(rank),\n    mean = mean(rank),\n    sd = sd(rank),\n    pct_rank1 = sum(rank == 1) / n() * 100\n  ) %>%\n  mutate(item = recode(item, !!!qol_labels))\n\nkable(qol_desc, digits = 2, caption = \"QoL Subfactors - Descriptive Statistics\")\n```\n\n::: {.cell-output-display}\n\n\nTable: QoL Subfactors - Descriptive Statistics\n\n|item                     |  n| median| mean|   sd| pct_rank1|\n|:------------------------|--:|------:|----:|----:|---------:|\n|Predictable schedule     | 76|      2| 2.51| 1.13|     19.74|\n|Vacation time            | 76|      4| 4.12| 1.18|      1.32|\n|Family-friendly policies | 76|      5| 4.53| 1.28|      1.32|\n|Home base possibility    | 76|      2| 2.70| 1.87|     39.47|\n|Travel benefits          | 76|      5| 4.87| 1.20|      1.32|\n|Work-life balance        | 76|      2| 2.28| 1.41|     36.84|\n\n\n:::\n\n```{.r .cell-code}\n# Friedman test\nfriedman_qol <- qol_long %>%\n  friedman_test(rank ~ item | respondent_id)\n\nkable(friedman_qol, digits = 3, caption = \"QoL: Friedman Test (Within-Construct Comparison)\")\n```\n\n::: {.cell-output-display}\n\n\nTable: QoL: Friedman Test (Within-Construct Comparison)\n\n|.y.  |  n| statistic| df|  p|method        |\n|:----|--:|---------:|--:|--:|:-------------|\n|rank | 76|   139.489|  5|  0|Friedman test |\n\n\n:::\n\n```{.r .cell-code}\n# Median rank visualization\nqol_plot <- qol_desc %>%\n  mutate(item = fct_reorder(item, desc(median))) %>%\n  ggplot(aes(x = median, y = item)) +\n  geom_col(fill = \"forestgreen\", alpha = 0.8) +\n  geom_text(aes(label = sprintf(\"%.1f\", median)), hjust = -0.2, size = 3) +\n  labs(\n    title = \"Quality of Life Subfactor Priorities\",\n    subtitle = \"Median rank (lower = higher priority)\",\n    x = \"Median Rank\",\n    y = NULL\n  ) +\n  theme_minimal() +\n  theme(plot.title = element_text(face = \"bold\"))\n\nprint(qol_plot)\n```\n\n::: {.cell-output-display}\n![](subfactor_analysis_files/figure-docx/qol-1.png)\n:::\n\n```{.r .cell-code}\nggsave(\"../../output/figures/subfactor_analysis/qol_median_ranks.png\",\n       qol_plot, width = 8, height = 5, dpi = 300)\n\n# Age group\nmw_age_qol <- qol_long %>%\n  filter(!is.na(age_group)) %>%\n  group_by(item) %>%\n  safe_wilcox_test(rank ~ age_group, exact = FALSE) %>%\n  ungroup()\n\nif (nrow(mw_age_qol) > 0) {\n  mw_age_qol <- mw_age_qol %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!qol_labels))\n}\n\nkable(mw_age_qol, digits = 3, caption = \"QoL: Age Group Comparisons\")\n```\n\n::: {.cell-output-display}\n\n\nTable: QoL: Age Group Comparisons\n\n|item                     | statistic|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:------------------------|---------:|-----:|----------:|:------------|-------:|:---------|\n|Predictable schedule     |     329.5| 0.015|      0.088|ns           |   0.281|small     |\n|Vacation time            |     544.5| 0.780|      1.000|ns           |   0.033|small     |\n|Family-friendly policies |     481.0| 0.610|      1.000|ns           |   0.059|small     |\n|Home base possibility    |     529.5| 0.929|      1.000|ns           |   0.011|small     |\n|Travel benefits          |     570.0| 0.543|      1.000|ns           |   0.071|small     |\n|Work-life balance        |     640.0| 0.134|      0.670|ns           |   0.173|small     |\n\n\n:::\n\n```{.r .cell-code}\n# Gender\nmw_gender_qol <- qol_long %>%\n  filter(!is.na(gender_clean)) %>%\n  group_by(item) %>%\n  safe_wilcox_test(rank ~ gender_clean, exact = FALSE) %>%\n  ungroup()\n\nif (nrow(mw_gender_qol) > 0) {\n  mw_gender_qol <- mw_gender_qol %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!qol_labels))\n}\n\nkable(mw_gender_qol, digits = 3, caption = \"QoL: Gender Comparisons\")\n```\n\n::: {.cell-output-display}\n\n\nTable: QoL: Gender Comparisons\n\n|item                     | statistic|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:------------------------|---------:|-----:|----------:|:------------|-------:|:---------|\n|Predictable schedule     |     197.5| 0.212|      1.000|ns           |   0.145|small     |\n|Vacation time            |     253.5| 0.803|      1.000|ns           |   0.030|small     |\n|Family-friendly policies |     265.5| 0.972|      1.000|ns           |   0.005|small     |\n|Home base possibility    |     259.0| 0.880|      1.000|ns           |   0.019|small     |\n|Travel benefits          |     359.5| 0.102|      0.612|ns           |   0.190|small     |\n|Work-life balance        |     290.5| 0.693|      1.000|ns           |   0.047|small     |\n\n\n:::\n\n```{.r .cell-code}\n# Position\nmw_position_qol <- qol_long %>%\n  filter(!is.na(position)) %>%\n  group_by(item) %>%\n  safe_wilcox_test(rank ~ position, exact = FALSE) %>%\n  ungroup()\n\nif (nrow(mw_position_qol) > 0) {\n  mw_position_qol <- mw_position_qol %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!qol_labels))\n}\n\nkable(mw_position_qol, digits = 3, caption = \"QoL: Position Comparisons\")\n```\n\n::: {.cell-output-display}\n\n\nTable: QoL: Position Comparisons\n\n|item                     | statistic|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:------------------------|---------:|-----:|----------:|:------------|-------:|:---------|\n|Predictable schedule     |     722.0| 0.415|          1|ns           |   0.094|small     |\n|Vacation time            |     604.0| 0.605|          1|ns           |   0.060|small     |\n|Family-friendly policies |     739.5| 0.315|          1|ns           |   0.116|small     |\n|Home base possibility    |     556.0| 0.287|          1|ns           |   0.123|small     |\n|Travel benefits          |     576.5| 0.402|          1|ns           |   0.097|small     |\n|Work-life balance        |     711.5| 0.485|          1|ns           |   0.081|small     |\n\n\n:::\n\n```{.r .cell-code}\n# Military\nmw_military_qol <- qol_long %>%\n  filter(!is.na(military_clean)) %>%\n  group_by(item) %>%\n  safe_wilcox_test(rank ~ military_clean, exact = FALSE) %>%\n  ungroup()\n\nif (nrow(mw_military_qol) > 0) {\n  mw_military_qol <- mw_military_qol %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!qol_labels))\n}\n\nkable(mw_military_qol, digits = 3, caption = \"QoL: Military Comparisons\")\n```\n\n::: {.cell-output-display}\n\n\nTable: QoL: Military Comparisons\n\n|item                     | statistic|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:------------------------|---------:|-----:|----------:|:------------|-------:|:---------|\n|Predictable schedule     |     193.5| 0.375|      1.000|ns           |   0.103|small     |\n|Vacation time            |     216.0| 0.641|      1.000|ns           |   0.055|small     |\n|Family-friendly policies |     200.5| 0.453|      1.000|ns           |   0.087|small     |\n|Home base possibility    |     357.5| 0.031|      0.186|ns           |   0.249|small     |\n|Travel benefits          |     236.5| 0.932|      1.000|ns           |   0.011|small     |\n|Work-life balance        |     198.0| 0.420|      1.000|ns           |   0.094|small     |\n\n\n:::\n\n```{.r .cell-code}\n# Experience\nkw_exp_qol <- qol_long %>%\n  filter(!is.na(exp_q)) %>%\n  group_by(item) %>%\n  safe_kruskal_test(rank ~ exp_q) %>%\n  ungroup()\n\nif (nrow(kw_exp_qol) > 0) {\n  kw_exp_qol <- kw_exp_qol %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, df, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!qol_labels))\n}\n\nkable(kw_exp_qol, digits = 3, caption = \"QoL: Experience Comparisons\")\n```\n\n::: {.cell-output-display}\n\n\nTable: QoL: Experience Comparisons\n\n|item                     | statistic| df|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:------------------------|---------:|--:|-----:|----------:|:------------|-------:|:---------|\n|Predictable schedule     |     7.452|  3| 0.059|      0.353|ns           |   0.062|moderate  |\n|Vacation time            |     5.189|  3| 0.158|      0.790|ns           |   0.030|small     |\n|Family-friendly policies |     4.905|  3| 0.179|      0.790|ns           |   0.026|small     |\n|Home base possibility    |     2.634|  3| 0.451|      1.000|ns           |  -0.005|small     |\n|Travel benefits          |     1.214|  3| 0.750|      1.000|ns           |  -0.025|small     |\n|Work-life balance        |     1.712|  3| 0.634|      1.000|ns           |  -0.018|small     |\n\n\n:::\n\n```{.r .cell-code}\n# Save tables to CSV\nwrite_csv(qol_desc, \"../../output/tables/subfactor_analysis/qol_descriptive.csv\")\nwrite_csv(friedman_qol, \"../../output/tables/subfactor_analysis/qol_friedman.csv\")\nif (nrow(mw_age_qol) > 0) write_csv(mw_age_qol, \"../../output/tables/subfactor_analysis/qol_age.csv\")\nif (nrow(mw_gender_qol) > 0) write_csv(mw_gender_qol, \"../../output/tables/subfactor_analysis/qol_gender.csv\")\nif (nrow(mw_position_qol) > 0) write_csv(mw_position_qol, \"../../output/tables/subfactor_analysis/qol_position.csv\")\nif (nrow(mw_military_qol) > 0) write_csv(mw_military_qol, \"../../output/tables/subfactor_analysis/qol_military.csv\")\nif (nrow(kw_exp_qol) > 0) write_csv(kw_exp_qol, \"../../output/tables/subfactor_analysis/qol_experience.csv\")\n\n# Collect minimum p-value for screening\nmin_p_qol <- min(\n  if(nrow(mw_age_qol) > 0) min(mw_age_qol$p) else 1,\n  if(nrow(mw_gender_qol) > 0) min(mw_gender_qol$p) else 1,\n  if(nrow(mw_position_qol) > 0) min(mw_position_qol$p) else 1,\n  if(nrow(mw_military_qol) > 0) min(mw_military_qol$p) else 1,\n  if(nrow(kw_exp_qol) > 0) min(kw_exp_qol$p) else 1\n)\n\nscreening_results <- screening_results %>%\n  add_row(\n    construct = \"Quality of Life\",\n    min_p = min_p_qol,\n    n_subfactors = 6\n  )\n\ncat(\"Quality of Life screening p-value:\", round(min_p_qol, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nQuality of Life screening p-value: 0.0147 \n```\n\n\n:::\n:::\n\n\n# Professional Subfactors\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncat(\"\\n========================================\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n========================================\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"PROFESSIONAL SUBFACTORS\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPROFESSIONAL SUBFACTORS\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"========================================\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n========================================\n```\n\n\n:::\n\n```{.r .cell-code}\nprofessional_long <- included_data %>%\n  select(age_group, gender_clean, position, exp_q, military_clean,\n         professional_1:professional_5) %>%\n  mutate(respondent_id = row_number()) %>%  # Create persistent ID before pivoting\n  mutate(across(professional_1:professional_5, as.numeric)) %>%\n  pivot_longer(\n    cols = professional_1:professional_5,\n    names_to = \"item\",\n    values_to = \"rank\"\n  ) %>%\n  filter(!is.na(rank))\n\n# Descriptive\nprofessional_desc <- professional_long %>%\n  group_by(item) %>%\n  summarise(n = n(), median = median(rank), mean = mean(rank),\n            sd = sd(rank), pct_rank1 = sum(rank == 1) / n() * 100) %>%\n  mutate(item = recode(item, !!!professional_labels))\nkable(professional_desc, digits = 2, caption = \"Professional Subfactors - Descriptive Statistics\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Professional Subfactors - Descriptive Statistics\n\n|item                       |  n| median| mean|   sd| pct_rank1|\n|:--------------------------|--:|------:|----:|----:|---------:|\n|Financially stable airline | 76|      1| 1.18| 0.42|     82.89|\n|Rapid upgrade opportunity  | 76|      3| 3.45| 1.09|      1.32|\n|Fly larger aircraft        | 76|      3| 3.26| 1.43|     10.53|\n|Merit-based promotion      | 76|      3| 3.45| 1.24|      5.26|\n|Seniority-based upgrade    | 76|      4| 3.66| 0.97|      0.00|\n\n\n:::\n\n```{.r .cell-code}\n# Friedman\nfriedman_prof <- professional_long %>%\n  friedman_test(rank ~ item | respondent_id)\nkable(friedman_prof, digits = 3, caption = \"Professional: Friedman Test (Within-Construct Comparison)\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Professional: Friedman Test (Within-Construct Comparison)\n\n|.y.  |  n| statistic| df|  p|method        |\n|:----|--:|---------:|--:|--:|:-------------|\n|rank | 76|   127.663|  4|  0|Friedman test |\n\n\n:::\n\n```{.r .cell-code}\n# Median rank visualization\nprofessional_plot <- professional_desc %>%\n  mutate(item = fct_reorder(item, desc(median))) %>%\n  ggplot(aes(x = median, y = item)) +\n  geom_col(fill = \"darkorange\", alpha = 0.8) +\n  geom_text(aes(label = sprintf(\"%.1f\", median)), hjust = -0.2, size = 3) +\n  labs(\n    title = \"Professional Opportunity Subfactor Priorities\",\n    subtitle = \"Median rank (lower = higher priority)\",\n    x = \"Median Rank\",\n    y = NULL\n  ) +\n  theme_minimal() +\n  theme(plot.title = element_text(face = \"bold\"))\n\nprint(professional_plot)\n```\n\n::: {.cell-output-display}\n![](subfactor_analysis_files/figure-docx/professional-1.png)\n:::\n\n```{.r .cell-code}\nggsave(\"../../output/figures/subfactor_analysis/professional_median_ranks.png\",\n       professional_plot, width = 8, height = 5, dpi = 300)\n\n# Demographics\nmw_age_prof <- professional_long %>%\n  filter(!is.na(age_group)) %>%\n  group_by(item) %>%\n  safe_wilcox_test(rank ~ age_group, exact = FALSE) %>%\n  ungroup()\n\nif (nrow(mw_age_prof) > 0) {\n  mw_age_prof <- mw_age_prof %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!professional_labels))\n}\n\nkable(mw_age_prof, digits = 3, caption = \"Professional: Age Comparisons\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Professional: Age Comparisons\n\n|item                       | statistic|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:--------------------------|---------:|-----:|----------:|:------------|-------:|:---------|\n|Financially stable airline |     442.5| 0.139|      0.695|ns           |   0.171|small     |\n|Rapid upgrade opportunity  |     560.0| 0.636|      1.000|ns           |   0.055|small     |\n|Fly larger aircraft        |     558.5| 0.650|      1.000|ns           |   0.053|small     |\n|Merit-based promotion      |     495.0| 0.739|      1.000|ns           |   0.039|small     |\n|Seniority-based upgrade    |     498.5| 0.769|      1.000|ns           |   0.034|small     |\n\n\n:::\n\n```{.r .cell-code}\nmw_gender_prof <- professional_long %>%\n  filter(!is.na(gender_clean)) %>%\n  group_by(item) %>%\n  safe_wilcox_test(rank ~ gender_clean, exact = FALSE) %>%\n  ungroup()\n\nif (nrow(mw_gender_prof) > 0) {\n  mw_gender_prof <- mw_gender_prof %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!professional_labels))\n}\n\nkable(mw_gender_prof, digits = 3, caption = \"Professional: Gender Comparisons\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Professional: Gender Comparisons\n\n|item                       | statistic|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:--------------------------|---------:|-----:|----------:|:------------|-------:|:---------|\n|Financially stable airline |     253.0| 0.705|      1.000|ns           |   0.045|small     |\n|Rapid upgrade opportunity  |     316.5| 0.394|      1.000|ns           |   0.099|small     |\n|Fly larger aircraft        |     355.5| 0.123|      0.492|ns           |   0.179|small     |\n|Merit-based promotion      |     173.5| 0.097|      0.484|ns           |   0.193|small     |\n|Seniority-based upgrade    |     216.5| 0.360|      1.000|ns           |   0.107|small     |\n\n\n:::\n\n```{.r .cell-code}\nmw_position_prof <- professional_long %>%\n  filter(!is.na(position)) %>%\n  group_by(item) %>%\n  safe_wilcox_test(rank ~ position, exact = FALSE) %>%\n  ungroup()\n\nif (nrow(mw_position_prof) > 0) {\n  mw_position_prof <- mw_position_prof %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!professional_labels))\n}\n\nkable(mw_position_prof, digits = 3, caption = \"Professional: Position Comparisons\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Professional: Position Comparisons\n\n|item                       | statistic|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:--------------------------|---------:|-----:|----------:|:------------|-------:|:---------|\n|Financially stable airline |     593.5| 0.348|          1|ns           |   0.109|small     |\n|Rapid upgrade opportunity  |     696.5| 0.603|          1|ns           |   0.060|small     |\n|Fly larger aircraft        |     679.5| 0.743|          1|ns           |   0.038|small     |\n|Merit-based promotion      |     645.0| 0.960|          1|ns           |   0.006|small     |\n|Seniority-based upgrade    |     578.0| 0.414|          1|ns           |   0.094|small     |\n\n\n:::\n\n```{.r .cell-code}\nmw_military_prof <- professional_long %>%\n  filter(!is.na(military_clean)) %>%\n  group_by(item) %>%\n  safe_wilcox_test(rank ~ military_clean, exact = FALSE) %>%\n  ungroup()\n\nif (nrow(mw_military_prof) > 0) {\n  mw_military_prof <- mw_military_prof %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!professional_labels))\n}\n\nkable(mw_military_prof, digits = 3, caption = \"Professional: Military Comparisons\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Professional: Military Comparisons\n\n|item                       | statistic|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:--------------------------|---------:|-----:|----------:|:------------|-------:|:---------|\n|Financially stable airline |     287.0| 0.216|      0.648|ns           |   0.144|small     |\n|Rapid upgrade opportunity  |     323.5| 0.130|      0.520|ns           |   0.175|small     |\n|Fly larger aircraft        |     135.0| 0.049|      0.246|ns           |   0.227|small     |\n|Merit-based promotion      |     229.0| 0.824|      0.824|ns           |   0.027|small     |\n|Seniority-based upgrade    |     303.0| 0.253|      0.648|ns           |   0.132|small     |\n\n\n:::\n\n```{.r .cell-code}\nkw_exp_prof <- professional_long %>%\n  filter(!is.na(exp_q)) %>%\n  group_by(item) %>%\n  safe_kruskal_test(rank ~ exp_q) %>%\n  ungroup()\n\nif (nrow(kw_exp_prof) > 0) {\n  kw_exp_prof <- kw_exp_prof %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, df, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!professional_labels))\n}\n\nkable(kw_exp_prof, digits = 3, caption = \"Professional: Experience Comparisons\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Professional: Experience Comparisons\n\n|item                       | statistic| df|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:--------------------------|---------:|--:|-----:|----------:|:------------|-------:|:---------|\n|Financially stable airline |     1.667|  3| 0.644|      1.000|ns           |  -0.019|small     |\n|Rapid upgrade opportunity  |     2.979|  3| 0.395|      1.000|ns           |   0.000|small     |\n|Fly larger aircraft        |     0.302|  3| 0.960|      1.000|ns           |  -0.037|small     |\n|Merit-based promotion      |     2.428|  3| 0.488|      1.000|ns           |  -0.008|small     |\n|Seniority-based upgrade    |     6.135|  3| 0.105|      0.525|ns           |   0.044|small     |\n\n\n:::\n\n```{.r .cell-code}\n# Save tables to CSV\nwrite_csv(professional_desc, \"../../output/tables/subfactor_analysis/professional_descriptive.csv\")\nwrite_csv(friedman_prof, \"../../output/tables/subfactor_analysis/professional_friedman.csv\")\nif (nrow(mw_age_prof) > 0) write_csv(mw_age_prof, \"../../output/tables/subfactor_analysis/professional_age.csv\")\nif (nrow(mw_gender_prof) > 0) write_csv(mw_gender_prof, \"../../output/tables/subfactor_analysis/professional_gender.csv\")\nif (nrow(mw_position_prof) > 0) write_csv(mw_position_prof, \"../../output/tables/subfactor_analysis/professional_position.csv\")\nif (nrow(mw_military_prof) > 0) write_csv(mw_military_prof, \"../../output/tables/subfactor_analysis/professional_military.csv\")\nif (nrow(kw_exp_prof) > 0) write_csv(kw_exp_prof, \"../../output/tables/subfactor_analysis/professional_experience.csv\")\n\n# Collect minimum p-value for screening\nmin_p_prof <- min(\n  if(nrow(mw_age_prof) > 0) min(mw_age_prof$p) else 1,\n  if(nrow(mw_gender_prof) > 0) min(mw_gender_prof$p) else 1,\n  if(nrow(mw_position_prof) > 0) min(mw_position_prof$p) else 1,\n  if(nrow(mw_military_prof) > 0) min(mw_military_prof$p) else 1,\n  if(nrow(kw_exp_prof) > 0) min(kw_exp_prof$p) else 1\n)\n\nscreening_results <- screening_results %>%\n  add_row(\n    construct = \"Professional\",\n    min_p = min_p_prof,\n    n_subfactors = 5\n  )\n\ncat(\"Professional screening p-value:\", round(min_p_prof, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nProfessional screening p-value: 0.0493 \n```\n\n\n:::\n:::\n\n\n# Recognition Subfactors\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncat(\"\\n========================================\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n========================================\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"RECOGNITION SUBFACTORS\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRECOGNITION SUBFACTORS\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"========================================\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n========================================\n```\n\n\n:::\n\n```{.r .cell-code}\nrecognition_long <- included_data %>%\n  select(age_group, gender_clean, position, exp_q, military_clean,\n         recognition_1, recognition_3, recognition_4, recognition_7) %>%\n  mutate(respondent_id = row_number()) %>%  # Create persistent ID before pivoting\n  mutate(across(starts_with(\"recognition\"), as.numeric)) %>%\n  pivot_longer(\n    cols = starts_with(\"recognition\"),\n    names_to = \"item\",\n    values_to = \"rank\"\n  ) %>%\n  filter(!is.na(rank))\n\n# Descriptive\nrecognition_desc <- recognition_long %>%\n  group_by(item) %>%\n  summarise(n = n(), median = median(rank), mean = mean(rank),\n            sd = sd(rank), pct_rank1 = sum(rank == 1) / n() * 100) %>%\n  mutate(item = recode(item, !!!recognition_labels))\nkable(recognition_desc, digits = 2, caption = \"Recognition Subfactors - Descriptive Statistics\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Recognition Subfactors - Descriptive Statistics\n\n|item                             |  n| median| mean|   sd| pct_rank1|\n|:--------------------------------|--:|------:|----:|----:|---------:|\n|Professional uniforms            | 76|      3| 2.80| 0.97|     14.47|\n|Vacation for long service        | 76|      2| 2.04| 1.01|     36.84|\n|Professional respect/recognition | 76|      2| 1.78| 0.84|     44.74|\n|Airline recognition              | 76|      4| 3.38| 0.88|      3.95|\n\n\n:::\n\n```{.r .cell-code}\n# Friedman\nfriedman_recog <- recognition_long %>%\n  friedman_test(rank ~ item | respondent_id)\nkable(friedman_recog, digits = 3, caption = \"Recognition: Friedman Test (Within-Construct Comparison)\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Recognition: Friedman Test (Within-Construct Comparison)\n\n|.y.  |  n| statistic| df|  p|method        |\n|:----|--:|---------:|--:|--:|:-------------|\n|rank | 76|    73.168|  3|  0|Friedman test |\n\n\n:::\n\n```{.r .cell-code}\n# Median rank visualization\nrecognition_plot <- recognition_desc %>%\n  mutate(item = fct_reorder(item, desc(median))) %>%\n  ggplot(aes(x = median, y = item)) +\n  geom_col(fill = \"purple\", alpha = 0.8) +\n  geom_text(aes(label = sprintf(\"%.1f\", median)), hjust = -0.2, size = 3) +\n  labs(\n    title = \"Recognition Subfactor Priorities\",\n    subtitle = \"Median rank (lower = higher priority)\",\n    x = \"Median Rank\",\n    y = NULL\n  ) +\n  theme_minimal() +\n  theme(plot.title = element_text(face = \"bold\"))\n\nprint(recognition_plot)\n```\n\n::: {.cell-output-display}\n![](subfactor_analysis_files/figure-docx/recognition-1.png)\n:::\n\n```{.r .cell-code}\nggsave(\"../../output/figures/subfactor_analysis/recognition_median_ranks.png\",\n       recognition_plot, width = 8, height = 5, dpi = 300)\n\n# Demographics\nmw_age_recog <- recognition_long %>%\n  filter(!is.na(age_group)) %>%\n  group_by(item) %>%\n  safe_wilcox_test(rank ~ age_group, exact = FALSE) %>%\n  ungroup()\n\nif (nrow(mw_age_recog) > 0) {\n  mw_age_recog <- mw_age_recog %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!recognition_labels))\n}\n\nkable(mw_age_recog, digits = 3, caption = \"Recognition: Age Comparisons\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Recognition: Age Comparisons\n\n|item                             | statistic|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:--------------------------------|---------:|-----:|----------:|:------------|-------:|:---------|\n|Professional uniforms            |       577| 0.476|      0.900|ns           |   0.082|small     |\n|Vacation for long service        |       345| 0.023|      0.093|ns           |   0.261|small     |\n|Professional respect/recognition |       601| 0.300|      0.900|ns           |   0.120|small     |\n|Airline recognition              |       579| 0.430|      0.900|ns           |   0.091|small     |\n\n\n:::\n\n```{.r .cell-code}\nmw_gender_recog <- recognition_long %>%\n  filter(!is.na(gender_clean)) %>%\n  group_by(item) %>%\n  safe_wilcox_test(rank ~ gender_clean, exact = FALSE) %>%\n  ungroup()\n\nif (nrow(mw_gender_recog) > 0) {\n  mw_gender_recog <- mw_gender_recog %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!recognition_labels))\n}\n\nkable(mw_gender_recog, digits = 3, caption = \"Recognition: Gender Comparisons\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Recognition: Gender Comparisons\n\n|item                             | statistic|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:--------------------------------|---------:|-----:|----------:|:------------|-------:|:---------|\n|Professional uniforms            |     183.0| 0.120|      0.360|ns           |   0.180|small     |\n|Vacation for long service        |     247.5| 0.718|      1.000|ns           |   0.043|small     |\n|Professional respect/recognition |     264.0| 0.948|      1.000|ns           |   0.009|small     |\n|Airline recognition              |     384.0| 0.023|      0.091|ns           |   0.264|small     |\n\n\n:::\n\n```{.r .cell-code}\nmw_position_recog <- recognition_long %>%\n  filter(!is.na(position)) %>%\n  group_by(item) %>%\n  safe_wilcox_test(rank ~ position, exact = FALSE) %>%\n  ungroup()\n\nif (nrow(mw_position_recog) > 0) {\n  mw_position_recog <- mw_position_recog %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!recognition_labels))\n}\n\nkable(mw_position_recog, digits = 3, caption = \"Recognition: Position Comparisons\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Recognition: Position Comparisons\n\n|item                             | statistic|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:--------------------------------|---------:|-----:|----------:|:------------|-------:|:---------|\n|Professional uniforms            |     767.5| 0.171|      0.513|ns           |   0.158|small     |\n|Vacation for long service        |     496.5| 0.078|      0.312|ns           |   0.203|small     |\n|Professional respect/recognition |     724.0| 0.385|      0.770|ns           |   0.100|small     |\n|Airline recognition              |     618.0| 0.694|      0.770|ns           |   0.046|small     |\n\n\n:::\n\n```{.r .cell-code}\nmw_military_recog <- recognition_long %>%\n  filter(!is.na(military_clean)) %>%\n  group_by(item) %>%\n  safe_wilcox_test(rank ~ military_clean, exact = FALSE) %>%\n  ungroup()\n\nif (nrow(mw_military_recog) > 0) {\n  mw_military_recog <- mw_military_recog %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!recognition_labels))\n}\n\nkable(mw_military_recog, digits = 3, caption = \"Recognition: Military Comparisons\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Recognition: Military Comparisons\n\n|item                             | statistic|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:--------------------------------|---------:|-----:|----------:|:------------|-------:|:---------|\n|Professional uniforms            |     119.5| 0.020|      0.078|ns           |   0.269|small     |\n|Vacation for long service        |     355.5| 0.032|      0.096|ns           |   0.247|small     |\n|Professional respect/recognition |     214.0| 0.600|      1.000|ns           |   0.061|small     |\n|Airline recognition              |     274.0| 0.511|      1.000|ns           |   0.077|small     |\n\n\n:::\n\n```{.r .cell-code}\nkw_exp_recog <- recognition_long %>%\n  filter(!is.na(exp_q)) %>%\n  group_by(item) %>%\n  safe_kruskal_test(rank ~ exp_q) %>%\n  ungroup()\n\nif (nrow(kw_exp_recog) > 0) {\n  kw_exp_recog <- kw_exp_recog %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, df, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!recognition_labels))\n}\n\nkable(kw_exp_recog, digits = 3, caption = \"Recognition: Experience Comparisons\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Recognition: Experience Comparisons\n\n|item                             | statistic| df|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:--------------------------------|---------:|--:|-----:|----------:|:------------|-------:|:---------|\n|Professional uniforms            |     4.887|  3| 0.180|      0.540|ns           |   0.026|small     |\n|Vacation for long service        |     8.274|  3| 0.041|      0.163|ns           |   0.073|moderate  |\n|Professional respect/recognition |     1.184|  3| 0.757|      1.000|ns           |  -0.025|small     |\n|Airline recognition              |     0.637|  3| 0.888|      1.000|ns           |  -0.033|small     |\n\n\n:::\n\n```{.r .cell-code}\n# Save tables to CSV\nwrite_csv(recognition_desc, \"../../output/tables/subfactor_analysis/recognition_descriptive.csv\")\nwrite_csv(friedman_recog, \"../../output/tables/subfactor_analysis/recognition_friedman.csv\")\nif (nrow(mw_age_recog) > 0) write_csv(mw_age_recog, \"../../output/tables/subfactor_analysis/recognition_age.csv\")\nif (nrow(mw_gender_recog) > 0) write_csv(mw_gender_recog, \"../../output/tables/subfactor_analysis/recognition_gender.csv\")\nif (nrow(mw_position_recog) > 0) write_csv(mw_position_recog, \"../../output/tables/subfactor_analysis/recognition_position.csv\")\nif (nrow(mw_military_recog) > 0) write_csv(mw_military_recog, \"../../output/tables/subfactor_analysis/recognition_military.csv\")\nif (nrow(kw_exp_recog) > 0) write_csv(kw_exp_recog, \"../../output/tables/subfactor_analysis/recognition_experience.csv\")\n\n# Collect minimum p-value for screening\nmin_p_recog <- min(\n  if(nrow(mw_age_recog) > 0) min(mw_age_recog$p) else 1,\n  if(nrow(mw_gender_recog) > 0) min(mw_gender_recog$p) else 1,\n  if(nrow(mw_position_recog) > 0) min(mw_position_recog$p) else 1,\n  if(nrow(mw_military_recog) > 0) min(mw_military_recog$p) else 1,\n  if(nrow(kw_exp_recog) > 0) min(kw_exp_recog$p) else 1\n)\n\nscreening_results <- screening_results %>%\n  add_row(\n    construct = \"Recognition\",\n    min_p = min_p_recog,\n    n_subfactors = 4\n  )\n\ncat(\"Recognition screening p-value:\", round(min_p_recog, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRecognition screening p-value: 0.0196 \n```\n\n\n:::\n:::\n\n\n# Schedule Subfactors\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncat(\"\\n========================================\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n========================================\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"SCHEDULE SUBFACTORS\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSCHEDULE SUBFACTORS\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"========================================\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n========================================\n```\n\n\n:::\n\n```{.r .cell-code}\nschedule_long <- included_data %>%\n  select(age_group, gender_clean, position, exp_q, military_clean,\n         schedule_1:schedule_5) %>%\n  mutate(respondent_id = row_number()) %>%  # Create persistent ID before pivoting\n  mutate(across(schedule_1:schedule_5, as.numeric)) %>%\n  pivot_longer(\n    cols = schedule_1:schedule_5,\n    names_to = \"item\",\n    values_to = \"rank\"\n  ) %>%\n  filter(!is.na(rank))\n\n# Descriptive\nschedule_desc <- schedule_long %>%\n  group_by(item) %>%\n  summarise(n = n(), median = median(rank), mean = mean(rank),\n            sd = sd(rank), pct_rank1 = sum(rank == 1) / n() * 100) %>%\n  mutate(item = recode(item, !!!schedule_labels))\nkable(schedule_desc, digits = 2, caption = \"Schedule Subfactors - Descriptive Statistics\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Schedule Subfactors - Descriptive Statistics\n\n|item                      |  n| median| mean|   sd| pct_rank1|\n|:-------------------------|--:|------:|----:|----:|---------:|\n|Fixed schedule            | 76|    3.5| 3.18| 1.64|     25.00|\n|Variable schedule         | 76|    3.0| 3.39| 1.39|     14.47|\n|Flexible work rules       | 76|    2.0| 2.12| 1.31|     42.11|\n|Bid line seniority system | 76|    3.0| 2.82| 1.27|     18.42|\n|Vacation bidding rules    | 76|    3.0| 3.49| 0.97|      0.00|\n\n\n:::\n\n```{.r .cell-code}\n# Friedman\nfriedman_sched <- schedule_long %>%\n  friedman_test(rank ~ item | respondent_id)\nkable(friedman_sched, digits = 3, caption = \"Schedule: Friedman Test (Within-Construct Comparison)\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Schedule: Friedman Test (Within-Construct Comparison)\n\n|.y.  |  n| statistic| df|  p|method        |\n|:----|--:|---------:|--:|--:|:-------------|\n|rank | 76|    37.632|  4|  0|Friedman test |\n\n\n:::\n\n```{.r .cell-code}\n# Median rank visualization\nschedule_plot <- schedule_desc %>%\n  mutate(item = fct_reorder(item, desc(median))) %>%\n  ggplot(aes(x = median, y = item)) +\n  geom_col(fill = \"firebrick\", alpha = 0.8) +\n  geom_text(aes(label = sprintf(\"%.1f\", median)), hjust = -0.2, size = 3) +\n  labs(\n    title = \"Schedule Subfactor Priorities\",\n    subtitle = \"Median rank (lower = higher priority)\",\n    x = \"Median Rank\",\n    y = NULL\n  ) +\n  theme_minimal() +\n  theme(plot.title = element_text(face = \"bold\"))\n\nprint(schedule_plot)\n```\n\n::: {.cell-output-display}\n![](subfactor_analysis_files/figure-docx/schedule-1.png)\n:::\n\n```{.r .cell-code}\nggsave(\"../../output/figures/subfactor_analysis/schedule_median_ranks.png\",\n       schedule_plot, width = 8, height = 5, dpi = 300)\n\n# Demographics\nmw_age_sched <- schedule_long %>%\n  filter(!is.na(age_group)) %>%\n  group_by(item) %>%\n  safe_wilcox_test(rank ~ age_group, exact = FALSE) %>%\n  ungroup()\n\nif (nrow(mw_age_sched) > 0) {\n  mw_age_sched <- mw_age_sched %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!schedule_labels))\n}\n\nkable(mw_age_sched, digits = 3, caption = \"Schedule: Age Comparisons\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Schedule: Age Comparisons\n\n|item                      | statistic|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:-------------------------|---------:|-----:|----------:|:------------|-------:|:---------|\n|Fixed schedule            |     464.5| 0.472|       1.00|ns           |   0.083|small     |\n|Variable schedule         |     493.5| 0.724|       1.00|ns           |   0.041|small     |\n|Flexible work rules       |     669.0| 0.058|       0.29|ns           |   0.218|small     |\n|Bid line seniority system |     574.5| 0.514|       1.00|ns           |   0.076|small     |\n|Vacation bidding rules    |     479.0| 0.588|       1.00|ns           |   0.063|small     |\n\n\n:::\n\n```{.r .cell-code}\nmw_gender_sched <- schedule_long %>%\n  filter(!is.na(gender_clean)) %>%\n  group_by(item) %>%\n  safe_wilcox_test(rank ~ gender_clean, exact = FALSE) %>%\n  ungroup()\n\nif (nrow(mw_gender_sched) > 0) {\n  mw_gender_sched <- mw_gender_sched %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!schedule_labels))\n}\n\nkable(mw_gender_sched, digits = 3, caption = \"Schedule: Gender Comparisons\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Schedule: Gender Comparisons\n\n|item                      | statistic|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:-------------------------|---------:|-----:|----------:|:------------|-------:|:---------|\n|Fixed schedule            |     202.5| 0.248|      0.992|ns           |   0.134|small     |\n|Variable schedule         |     387.0| 0.036|      0.180|ns           |   0.243|small     |\n|Flexible work rules       |     229.5| 0.489|      0.992|ns           |   0.081|small     |\n|Bid line seniority system |     270.5| 0.972|      0.992|ns           |   0.005|small     |\n|Vacation bidding rules    |     204.0| 0.256|      0.992|ns           |   0.132|small     |\n\n\n:::\n\n```{.r .cell-code}\nmw_position_sched <- schedule_long %>%\n  filter(!is.na(position)) %>%\n  group_by(item) %>%\n  safe_wilcox_test(rank ~ position, exact = FALSE) %>%\n  ungroup()\n\nif (nrow(mw_position_sched) > 0) {\n  mw_position_sched <- mw_position_sched %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!schedule_labels))\n}\n\nkable(mw_position_sched, digits = 3, caption = \"Schedule: Position Comparisons\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Schedule: Position Comparisons\n\n|item                      | statistic|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:-------------------------|---------:|-----:|----------:|:------------|-------:|:---------|\n|Fixed schedule            |     606.0| 0.622|          1|ns           |   0.057|small     |\n|Variable schedule         |     647.0| 0.977|          1|ns           |   0.004|small     |\n|Flexible work rules       |     714.0| 0.462|          1|ns           |   0.085|small     |\n|Bid line seniority system |     747.5| 0.276|          1|ns           |   0.126|small     |\n|Vacation bidding rules    |     551.5| 0.263|          1|ns           |   0.129|small     |\n\n\n:::\n\n```{.r .cell-code}\nmw_military_sched <- schedule_long %>%\n  filter(!is.na(military_clean)) %>%\n  group_by(item) %>%\n  safe_wilcox_test(rank ~ military_clean, exact = FALSE) %>%\n  ungroup()\n\nif (nrow(mw_military_sched) > 0) {\n  mw_military_sched <- mw_military_sched %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!schedule_labels))\n}\n\nkable(mw_military_sched, digits = 3, caption = \"Schedule: Military Comparisons\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Schedule: Military Comparisons\n\n|item                      | statistic|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:-------------------------|---------:|-----:|----------:|:------------|-------:|:---------|\n|Fixed schedule            |     177.0| 0.235|          1|ns           |   0.137|small     |\n|Variable schedule         |     286.5| 0.410|          1|ns           |   0.096|small     |\n|Flexible work rules       |     227.5| 0.797|          1|ns           |   0.031|small     |\n|Bid line seniority system |     216.0| 0.645|          1|ns           |   0.054|small     |\n|Vacation bidding rules    |     257.0| 0.779|          1|ns           |   0.033|small     |\n\n\n:::\n\n```{.r .cell-code}\nkw_exp_sched <- schedule_long %>%\n  filter(!is.na(exp_q)) %>%\n  group_by(item) %>%\n  safe_kruskal_test(rank ~ exp_q) %>%\n  ungroup()\n\nif (nrow(kw_exp_sched) > 0) {\n  kw_exp_sched <- kw_exp_sched %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, df, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!schedule_labels))\n}\n\nkable(kw_exp_sched, digits = 3, caption = \"Schedule: Experience Comparisons\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Schedule: Experience Comparisons\n\n|item                      | statistic| df|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:-------------------------|---------:|--:|-----:|----------:|:------------|-------:|:---------|\n|Fixed schedule            |     1.454|  3| 0.693|      1.000|ns           |  -0.021|small     |\n|Variable schedule         |     0.483|  3| 0.923|      1.000|ns           |  -0.035|small     |\n|Flexible work rules       |     4.079|  3| 0.253|      0.968|ns           |   0.015|small     |\n|Bid line seniority system |     4.188|  3| 0.242|      0.968|ns           |   0.016|small     |\n|Vacation bidding rules    |     5.826|  3| 0.120|      0.600|ns           |   0.039|small     |\n\n\n:::\n\n```{.r .cell-code}\n# Save tables to CSV\nwrite_csv(schedule_desc, \"../../output/tables/subfactor_analysis/schedule_descriptive.csv\")\nwrite_csv(friedman_sched, \"../../output/tables/subfactor_analysis/schedule_friedman.csv\")\nif (nrow(mw_age_sched) > 0) write_csv(mw_age_sched, \"../../output/tables/subfactor_analysis/schedule_age.csv\")\nif (nrow(mw_gender_sched) > 0) write_csv(mw_gender_sched, \"../../output/tables/subfactor_analysis/schedule_gender.csv\")\nif (nrow(mw_position_sched) > 0) write_csv(mw_position_sched, \"../../output/tables/subfactor_analysis/schedule_position.csv\")\nif (nrow(mw_military_sched) > 0) write_csv(mw_military_sched, \"../../output/tables/subfactor_analysis/schedule_military.csv\")\nif (nrow(kw_exp_sched) > 0) write_csv(kw_exp_sched, \"../../output/tables/subfactor_analysis/schedule_experience.csv\")\n\n# Collect minimum p-value for screening\nmin_p_sched <- min(\n  if(nrow(mw_age_sched) > 0) min(mw_age_sched$p) else 1,\n  if(nrow(mw_gender_sched) > 0) min(mw_gender_sched$p) else 1,\n  if(nrow(mw_position_sched) > 0) min(mw_position_sched$p) else 1,\n  if(nrow(mw_military_sched) > 0) min(mw_military_sched$p) else 1,\n  if(nrow(kw_exp_sched) > 0) min(kw_exp_sched$p) else 1\n)\n\nscreening_results <- screening_results %>%\n  add_row(\n    construct = \"Schedule\",\n    min_p = min_p_sched,\n    n_subfactors = 5\n  )\n\ncat(\"Schedule screening p-value:\", round(min_p_sched, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSchedule screening p-value: 0.0359 \n```\n\n\n:::\n:::\n\n\n# Operational Subfactors\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncat(\"\\n========================================\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n========================================\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"OPERATIONAL SUBFACTORS\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOPERATIONAL SUBFACTORS\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"========================================\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n========================================\n```\n\n\n:::\n\n```{.r .cell-code}\noperational_long <- included_data %>%\n  select(age_group, gender_clean, position, exp_q, military_clean,\n         operational_1:operational_5) %>%\n  mutate(respondent_id = row_number()) %>%  # Create persistent ID before pivoting\n  mutate(across(operational_1:operational_5, as.numeric)) %>%\n  pivot_longer(\n    cols = operational_1:operational_5,\n    names_to = \"item\",\n    values_to = \"rank\"\n  ) %>%\n  filter(!is.na(rank))\n\n# Descriptive\noperational_desc <- operational_long %>%\n  group_by(item) %>%\n  summarise(n = n(), median = median(rank), mean = mean(rank),\n            sd = sd(rank), pct_rank1 = sum(rank == 1) / n() * 100) %>%\n  mutate(item = recode(item, !!!operational_labels))\nkable(operational_desc, digits = 2, caption = \"Operational Subfactors - Descriptive Statistics\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Operational Subfactors - Descriptive Statistics\n\n|item                     |  n| median| mean|   sd| pct_rank1|\n|:------------------------|--:|------:|----:|----:|---------:|\n|Unambiguous SOPs         | 76|      3| 3.07| 1.59|     28.95|\n|Proactive training       | 76|      3| 2.84| 1.17|     11.84|\n|Well-maintained aircraft | 76|      2| 2.25| 1.16|     35.53|\n|Well-equipped aircraft   | 76|      5| 4.13| 1.18|      1.32|\n|Highly skilled pilots    | 76|      3| 2.71| 1.24|     22.37|\n\n\n:::\n\n```{.r .cell-code}\n# Friedman\nfriedman_oper <- operational_long %>%\n  friedman_test(rank ~ item | respondent_id)\nkable(friedman_oper, digits = 3, caption = \"Operational: Friedman Test (Within-Construct Comparison)\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Operational: Friedman Test (Within-Construct Comparison)\n\n|.y.  |  n| statistic| df|  p|method        |\n|:----|--:|---------:|--:|--:|:-------------|\n|rank | 76|    59.463|  4|  0|Friedman test |\n\n\n:::\n\n```{.r .cell-code}\n# Median rank visualization\noperational_plot <- operational_desc %>%\n  mutate(item = fct_reorder(item, desc(median))) %>%\n  ggplot(aes(x = median, y = item)) +\n  geom_col(fill = \"darkslategray\", alpha = 0.8) +\n  geom_text(aes(label = sprintf(\"%.1f\", median)), hjust = -0.2, size = 3) +\n  labs(\n    title = \"Operational Subfactor Priorities\",\n    subtitle = \"Median rank (lower = higher priority)\",\n    x = \"Median Rank\",\n    y = NULL\n  ) +\n  theme_minimal() +\n  theme(plot.title = element_text(face = \"bold\"))\n\nprint(operational_plot)\n```\n\n::: {.cell-output-display}\n![](subfactor_analysis_files/figure-docx/operational-1.png)\n:::\n\n```{.r .cell-code}\nggsave(\"../../output/figures/subfactor_analysis/operational_median_ranks.png\",\n       operational_plot, width = 8, height = 5, dpi = 300)\n\n# Demographics\nmw_age_oper <- operational_long %>%\n  filter(!is.na(age_group)) %>%\n  group_by(item) %>%\n  safe_wilcox_test(rank ~ age_group, exact = FALSE) %>%\n  ungroup()\n\nif (nrow(mw_age_oper) > 0) {\n  mw_age_oper <- mw_age_oper %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!operational_labels))\n}\n\nkable(mw_age_oper, digits = 3, caption = \"Operational: Age Comparisons\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Operational: Age Comparisons\n\n|item                     | statistic|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:------------------------|---------:|-----:|----------:|:------------|-------:|:---------|\n|Unambiguous SOPs         |     486.0| 0.655|      1.000|ns           |   0.052|small     |\n|Proactive training       |     406.0| 0.145|      0.725|ns           |   0.168|small     |\n|Well-maintained aircraft |     556.0| 0.671|      1.000|ns           |   0.050|small     |\n|Well-equipped aircraft   |     551.5| 0.692|      1.000|ns           |   0.046|small     |\n|Highly skilled pilots    |     608.0| 0.283|      1.000|ns           |   0.124|small     |\n\n\n:::\n\n```{.r .cell-code}\nmw_gender_oper <- operational_long %>%\n  filter(!is.na(gender_clean)) %>%\n  group_by(item) %>%\n  safe_wilcox_test(rank ~ gender_clean, exact = FALSE) %>%\n  ungroup()\n\nif (nrow(mw_gender_oper) > 0) {\n  mw_gender_oper <- mw_gender_oper %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!operational_labels))\n}\n\nkable(mw_gender_oper, digits = 3, caption = \"Operational: Gender Comparisons\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Operational: Gender Comparisons\n\n|item                     | statistic|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:------------------------|---------:|-----:|----------:|:------------|-------:|:---------|\n|Unambiguous SOPs         |     255.0| 0.825|          1|ns           |   0.027|small     |\n|Proactive training       |     240.0| 0.626|          1|ns           |   0.057|small     |\n|Well-maintained aircraft |     237.0| 0.586|          1|ns           |   0.064|small     |\n|Well-equipped aircraft   |     328.5| 0.247|          1|ns           |   0.135|small     |\n|Highly skilled pilots    |     290.0| 0.705|          1|ns           |   0.045|small     |\n\n\n:::\n\n```{.r .cell-code}\nmw_position_oper <- operational_long %>%\n  filter(!is.na(position)) %>%\n  group_by(item) %>%\n  safe_wilcox_test(rank ~ position, exact = FALSE) %>%\n  ungroup()\n\nif (nrow(mw_position_oper) > 0) {\n  mw_position_oper <- mw_position_oper %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!operational_labels))\n}\n\nkable(mw_position_oper, digits = 3, caption = \"Operational: Position Comparisons\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Operational: Position Comparisons\n\n|item                     | statistic|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:------------------------|---------:|-----:|----------:|:------------|-------:|:---------|\n|Unambiguous SOPs         |     620.0| 0.740|          1|ns           |   0.039|small     |\n|Proactive training       |     722.5| 0.416|          1|ns           |   0.094|small     |\n|Well-maintained aircraft |     618.0| 0.720|          1|ns           |   0.042|small     |\n|Well-equipped aircraft   |     637.5| 0.883|          1|ns           |   0.018|small     |\n|Highly skilled pilots    |     655.5| 0.955|          1|ns           |   0.007|small     |\n\n\n:::\n\n```{.r .cell-code}\nmw_military_oper <- operational_long %>%\n  filter(!is.na(military_clean)) %>%\n  group_by(item) %>%\n  safe_wilcox_test(rank ~ military_clean, exact = FALSE) %>%\n  ungroup()\n\nif (nrow(mw_military_oper) > 0) {\n  mw_military_oper <- mw_military_oper %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!operational_labels))\n}\n\nkable(mw_military_oper, digits = 3, caption = \"Operational: Military Comparisons\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Operational: Military Comparisons\n\n|item                     | statistic|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:------------------------|---------:|-----:|----------:|:------------|-------:|:---------|\n|Unambiguous SOPs         |     287.0| 0.405|          1|ns           |   0.096|small     |\n|Proactive training       |     280.0| 0.481|          1|ns           |   0.082|small     |\n|Well-maintained aircraft |     218.0| 0.668|          1|ns           |   0.050|small     |\n|Well-equipped aircraft   |     204.5| 0.463|          1|ns           |   0.085|small     |\n|Highly skilled pilots    |     225.0| 0.768|          1|ns           |   0.035|small     |\n\n\n:::\n\n```{.r .cell-code}\nkw_exp_oper <- operational_long %>%\n  filter(!is.na(exp_q)) %>%\n  group_by(item) %>%\n  safe_kruskal_test(rank ~ exp_q) %>%\n  ungroup()\n\nif (nrow(kw_exp_oper) > 0) {\n  kw_exp_oper <- kw_exp_oper %>%\n    mutate(p_raw = p) %>%\n    adjust_pvalue(method = \"holm\") %>%\n    add_significance(\"p.adj\") %>%\n    select(item, statistic, df, p_raw, p.adj, p.adj.signif, effsize, magnitude) %>%\n    rename(p = p_raw, p_adj_holm = p.adj) %>%\n    mutate(item = recode(item, !!!operational_labels))\n}\n\nkable(kw_exp_oper, digits = 3, caption = \"Operational: Experience Comparisons\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Operational: Experience Comparisons\n\n|item                     | statistic| df|     p| p_adj_holm|p.adj.signif | effsize|magnitude |\n|:------------------------|---------:|--:|-----:|----------:|:------------|-------:|:---------|\n|Unambiguous SOPs         |     4.274|  3| 0.233|      0.932|ns           |   0.018|small     |\n|Proactive training       |     0.476|  3| 0.924|      1.000|ns           |  -0.035|small     |\n|Well-maintained aircraft |     1.985|  3| 0.575|      1.000|ns           |  -0.014|small     |\n|Well-equipped aircraft   |     0.326|  3| 0.955|      1.000|ns           |  -0.037|small     |\n|Highly skilled pilots    |     5.161|  3| 0.160|      0.800|ns           |   0.030|small     |\n\n\n:::\n\n```{.r .cell-code}\n# Save tables to CSV\nwrite_csv(operational_desc, \"../../output/tables/subfactor_analysis/operational_descriptive.csv\")\nwrite_csv(friedman_oper, \"../../output/tables/subfactor_analysis/operational_friedman.csv\")\nif (nrow(mw_age_oper) > 0) write_csv(mw_age_oper, \"../../output/tables/subfactor_analysis/operational_age.csv\")\nif (nrow(mw_gender_oper) > 0) write_csv(mw_gender_oper, \"../../output/tables/subfactor_analysis/operational_gender.csv\")\nif (nrow(mw_position_oper) > 0) write_csv(mw_position_oper, \"../../output/tables/subfactor_analysis/operational_position.csv\")\nif (nrow(mw_military_oper) > 0) write_csv(mw_military_oper, \"../../output/tables/subfactor_analysis/operational_military.csv\")\nif (nrow(kw_exp_oper) > 0) write_csv(kw_exp_oper, \"../../output/tables/subfactor_analysis/operational_experience.csv\")\n\n# Collect minimum p-value for screening\nmin_p_oper <- min(\n  if(nrow(mw_age_oper) > 0) min(mw_age_oper$p) else 1,\n  if(nrow(mw_gender_oper) > 0) min(mw_gender_oper$p) else 1,\n  if(nrow(mw_position_oper) > 0) min(mw_position_oper$p) else 1,\n  if(nrow(mw_military_oper) > 0) min(mw_military_oper$p) else 1,\n  if(nrow(kw_exp_oper) > 0) min(kw_exp_oper$p) else 1\n)\n\nscreening_results <- screening_results %>%\n  add_row(\n    construct = \"Operational\",\n    min_p = min_p_oper,\n    n_subfactors = 5\n  )\n\ncat(\"Operational screening p-value:\", round(min_p_oper, 4), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOperational screening p-value: 0.145 \n```\n\n\n:::\n:::\n\n\n# Construct-Level Screening Results\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Apply Benjamini-Hochberg FDR to Screening Results\n# ==================================================\n\ncat(\"\\n=== FINAL SCREENING RESULTS ===\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n=== FINAL SCREENING RESULTS ===\n```\n\n\n:::\n\n```{.r .cell-code}\n# Apply BH-FDR at q=0.10\nscreening_results <- screening_results %>%\n  arrange(min_p) %>%\n  mutate(\n    rank = row_number(),\n    p_adj_fdr = p.adjust(min_p, method = \"BH\"),\n    significant = p_adj_fdr < 0.10,\n    decision = if_else(significant, \"Proceed to detailed testing\", \"No demographic differences detected\")\n  )\n\n# Display results\nkable(\n  screening_results %>% select(construct, min_p, p_adj_fdr, significant, n_subfactors, decision),\n  digits = 4,\n  caption = \"Construct-Level Screening: Benjamini-Hochberg FDR (q=0.10)\",\n  col.names = c(\"Construct\", \"Min p-value\", \"p-adj (FDR)\", \"Significant\", \"N Subfactors\", \"Decision\")\n)\n```\n\n::: {.cell-output-display}\n\n\nTable: Construct-Level Screening: Benjamini-Hochberg FDR (q=0.10)\n\n|Construct       | Min p-value| p-adj (FDR)|Significant | N Subfactors|Decision                            |\n|:---------------|-----------:|-----------:|:-----------|------------:|:-----------------------------------|\n|Quality of Life |      0.0147|      0.0588|TRUE        |            6|Proceed to detailed testing         |\n|Recognition     |      0.0196|      0.0588|TRUE        |            4|Proceed to detailed testing         |\n|Schedule        |      0.0359|      0.0718|TRUE        |            5|Proceed to detailed testing         |\n|Professional    |      0.0493|      0.0739|TRUE        |            5|Proceed to detailed testing         |\n|Financial       |      0.0691|      0.0829|TRUE        |            6|Proceed to detailed testing         |\n|Operational     |      0.1450|      0.1450|FALSE       |            5|No demographic differences detected |\n\n\n:::\n\n```{.r .cell-code}\n# Count significant constructs\nn_significant <- sum(screening_results$significant)\ncat(\"\\nSignificant constructs (p_adj < 0.10):\", n_significant, \"of 6\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nSignificant constructs (p_adj < 0.10): 5 of 6\n```\n\n\n:::\n\n```{.r .cell-code}\n# Interpretation guidance\nif (n_significant > 0) {\n  cat(\"\\nFor constructs passing screening (p_adj < 0.10):\\n\")\n  cat(\"  Demographic comparisons within these constructs have been adjusted using\\n\")\n  cat(\"  Holm's procedure at α=0.05. Tests with p_adj_holm < 0.05 indicate\\n\")\n  cat(\"  specific demographics showing differences in subfactor rankings.\\n\\n\")\n\n  cat(\"For constructs NOT passing screening:\\n\")\n  cat(\"  No evidence of demographic differences at construct level.\\n\")\n  cat(\"  Individual demographic comparisons should be interpreted as exploratory only.\\n\")\n} else {\n  cat(\"\\nNo constructs showed significant demographic differences at construct level.\\n\")\n  cat(\"Individual demographic comparisons reported above are retained for completeness\\n\")\n  cat(\"and should be treated as exploratory outputs without confirmatory claims.\\n\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nFor constructs passing screening (p_adj < 0.10):\n  Demographic comparisons within these constructs have been adjusted using\n  Holm's procedure at α=0.05. Tests with p_adj_holm < 0.05 indicate\n  specific demographics showing differences in subfactor rankings.\n\nFor constructs NOT passing screening:\n  No evidence of demographic differences at construct level.\n  Individual demographic comparisons should be interpreted as exploratory only.\n```\n\n\n:::\n:::\n\n\n# Results Summary\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncount_sig <- function(tbl_name) {\n  if (!exists(tbl_name, inherits = TRUE)) return(0)\n  df <- get(tbl_name, inherits = TRUE)\n  if (!\"p_adj_holm\" %in% names(df)) return(0)\n  sum(df$p_adj_holm < 0.05, na.rm = TRUE)\n}\n\ncount_tests <- function(tbl_name) {\n  if (!exists(tbl_name, inherits = TRUE)) return(0)\n  nrow(get(tbl_name, inherits = TRUE))\n}\n\ndetailed_summary <- tibble::tibble(\n  Construct = c(\"Financial\", \"Quality of Life\", \"Professional\", \"Recognition\", \"Schedule\", \"Operational\"),\n  Age_tests = c(count_tests(\"mw_age_fin\"), count_tests(\"mw_age_qol\"), count_tests(\"mw_age_prof\"),\n                count_tests(\"mw_age_recog\"), count_tests(\"mw_age_sched\"), count_tests(\"mw_age_oper\")),\n  Age_significant = c(count_sig(\"mw_age_fin\"), count_sig(\"mw_age_qol\"), count_sig(\"mw_age_prof\"),\n                      count_sig(\"mw_age_recog\"), count_sig(\"mw_age_sched\"), count_sig(\"mw_age_oper\")),\n  Gender_tests = c(count_tests(\"mw_gender_fin\"), count_tests(\"mw_gender_qol\"), count_tests(\"mw_gender_prof\"),\n                   count_tests(\"mw_gender_recog\"), count_tests(\"mw_gender_sched\"), count_tests(\"mw_gender_oper\")),\n  Gender_significant = c(count_sig(\"mw_gender_fin\"), count_sig(\"mw_gender_qol\"), count_sig(\"mw_gender_prof\"),\n                         count_sig(\"mw_gender_recog\"), count_sig(\"mw_gender_sched\"), count_sig(\"mw_gender_oper\")),\n  Position_tests = c(count_tests(\"mw_position_fin\"), count_tests(\"mw_position_qol\"), count_tests(\"mw_position_prof\"),\n                     count_tests(\"mw_position_recog\"), count_tests(\"mw_position_sched\"), count_tests(\"mw_position_oper\")),\n  Position_significant = c(count_sig(\"mw_position_fin\"), count_sig(\"mw_position_qol\"), count_sig(\"mw_position_prof\"),\n                           count_sig(\"mw_position_recog\"), count_sig(\"mw_position_sched\"), count_sig(\"mw_position_oper\")),\n  Military_tests = c(count_tests(\"mw_military_fin\"), count_tests(\"mw_military_qol\"), count_tests(\"mw_military_prof\"),\n                     count_tests(\"mw_military_recog\"), count_tests(\"mw_military_sched\"), count_tests(\"mw_military_oper\")),\n  Military_significant = c(count_sig(\"mw_military_fin\"), count_sig(\"mw_military_qol\"), count_sig(\"mw_military_prof\"),\n                           count_sig(\"mw_military_recog\"), count_sig(\"mw_military_sched\"), count_sig(\"mw_military_oper\")),\n  Experience_tests = c(count_tests(\"kw_exp_fin\"), count_tests(\"kw_exp_qol\"), count_tests(\"kw_exp_prof\"),\n                       count_tests(\"kw_exp_recog\"), count_tests(\"kw_exp_sched\"), count_tests(\"kw_exp_oper\")),\n  Experience_significant = c(count_sig(\"kw_exp_fin\"), count_sig(\"kw_exp_qol\"), count_sig(\"kw_exp_prof\"),\n                             count_sig(\"kw_exp_recog\"), count_sig(\"kw_exp_sched\"), count_sig(\"kw_exp_oper\"))\n)\n\nknitr::kable(\n  detailed_summary,\n  caption = \"Counts of Holm-Adjusted Comparisons Below 0.05 by Construct and Demographic Group\"\n)\n```\n\n::: {.cell-output-display}\n\n\nTable: Counts of Holm-Adjusted Comparisons Below 0.05 by Construct and Demographic Group\n\n|Construct       | Age_tests| Age_significant| Gender_tests| Gender_significant| Position_tests| Position_significant| Military_tests| Military_significant| Experience_tests| Experience_significant|\n|:---------------|---------:|---------------:|------------:|------------------:|--------------:|--------------------:|--------------:|--------------------:|----------------:|----------------------:|\n|Financial       |         6|               0|            6|                  0|              6|                    0|              6|                    0|                6|                      0|\n|Quality of Life |         6|               0|            6|                  0|              6|                    0|              6|                    0|                6|                      0|\n|Professional    |         5|               0|            5|                  0|              5|                    0|              5|                    0|                5|                      0|\n|Recognition     |         4|               0|            4|                  0|              4|                    0|              4|                    0|                4|                      0|\n|Schedule        |         5|               0|            5|                  0|              5|                    0|              5|                    0|                5|                      0|\n|Operational     |         5|               0|            5|                  0|              5|                    0|              5|                    0|                5|                      0|\n\n\n:::\n:::\n\n\n# Conclusion\n\nThis analysis examined 31 subfactor rankings across six retention constructs (Financial, Quality of Life, Professional Opportunity, Recognition, Schedule, and Operational) and compared them across five demographic groups: age (≤35 vs >35), gender, position (Captain vs First Officer), military experience, and years of experience (quartiles).\n\n**Statistical Methods:** This exploratory pilot study employed a two-step hierarchical false discovery rate (FDR) control procedure. First, construct-level screening using Benjamini-Hochberg FDR at q=0.10 determined which of the six constructs showed demographic differences. Second, for constructs passing screening, individual demographic comparisons were adjusted using Holm's procedure at α=0.05. Mann-Whitney U tests were used for binary demographic comparisons, Kruskal-Wallis tests for experience quartiles, and Friedman tests for within-construct comparisons. All tests used proper respondent identifiers to maintain the repeated-measures structure of the data. Effect sizes (rank-biserial r for Mann-Whitney, eta-squared for Kruskal-Wallis) were computed for every test.\n\n**Key Outputs:** Construct-level screening results, detailed demographic tables (with raw and Holm-adjusted p-values), effect sizes (|r| < 0.3, η² < 0.06 across all tests), and median-rank visualizations are provided above.\n\n## Sample Characteristics\n\nThis analysis is based on n=76 valid pilot responses. Demographic breakdown used in testing:\n\n- Age groups: ≤35 (58 pilots) and >35 (18 pilots)\n- Gender: Male (67), Female (8); other/unspecified entries were excluded from binary comparisons\n- Position: Captain (26) and First Officer (50)\n- Military background: Military (7) and Civilian (69)\n- Experience quartiles: ntile-based groups containing 28 (Q1), 14 (Q2), 17 (Q3), and 17 (Q4) pilots, respectively\n\nEffect sizes for all demographic comparisons were within |r| < 0.3 for Mann-Whitney tests and η² < 0.06 for Kruskal-Wallis tests.\n\n# Session Info\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.5.2 (2025-10-31)\nPlatform: aarch64-apple-darwin20\nRunning under: macOS Tahoe 26.1\n\nMatrix products: default\nBLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] DescTools_0.99.60 janitor_2.2.1     knitr_1.50        rstatix_0.7.3    \n [5] lubridate_1.9.4   forcats_1.0.1     stringr_1.6.0     dplyr_1.1.4      \n [9] purrr_1.2.0       readr_2.1.5       tidyr_1.3.1       tibble_3.3.0     \n[13] ggplot2_4.0.0     tidyverse_2.0.0  \n\nloaded via a namespace (and not attached):\n [1] tidyselect_1.2.1   Exact_3.3          rootSolve_1.8.2.4  libcoin_1.0-10    \n [5] farver_2.1.2       S7_0.2.0           fastmap_1.2.0      TH.data_1.1-4     \n [9] digest_0.6.37      timechange_0.3.0   lifecycle_1.0.4    survival_3.8-3    \n[13] lmom_3.2           magrittr_2.0.4     compiler_4.5.2     rlang_1.1.6       \n[17] tools_4.5.2        yaml_2.3.10        data.table_1.17.8  labeling_0.4.3    \n[21] bit_4.6.0          RColorBrewer_1.1-3 multcomp_1.4-29    abind_1.4-8       \n[25] expm_1.0-0         withr_3.0.2        stats4_4.5.2       grid_4.5.2        \n[29] e1071_1.7-16       scales_1.4.0       MASS_7.3-65        cli_3.6.5         \n[33] mvtnorm_1.3-3      rmarkdown_2.30     crayon_1.5.3       ragg_1.5.0        \n[37] generics_0.1.4     rstudioapi_0.17.1  httr_1.4.7         tzdb_0.5.0        \n[41] readxl_1.4.5       gld_2.6.8          proxy_0.4-27       modeltools_0.2-24 \n[45] splines_4.5.2      parallel_4.5.2     cellranger_1.1.0   matrixStats_1.5.0 \n[49] vctrs_0.6.5        sandwich_3.1-1     boot_1.3-32        Matrix_1.7-4      \n[53] jsonlite_2.0.0     carData_3.0-5      car_3.1-3          hms_1.1.4         \n[57] bit64_4.6.0-1      Formula_1.2-5      systemfonts_1.3.1  glue_1.8.0        \n[61] codetools_0.2-20   stringi_1.8.7      gtable_0.3.6       pillar_1.11.1     \n[65] htmltools_0.5.8.1  R6_2.6.1           textshaping_1.0.4  vroom_1.6.6       \n[69] evaluate_1.0.5     lattice_0.22-7     haven_2.5.5        backports_1.5.0   \n[73] broom_1.0.10       snakecase_0.11.1   renv_1.1.5         class_7.3-23      \n[77] Rcpp_1.1.0         xfun_0.54          coin_1.4-3         zoo_1.8-14        \n[81] fs_1.6.6           pkgconfig_2.0.3   \n```\n\n\n:::\n:::\n\n",
    "supporting": [
      "subfactor_analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}