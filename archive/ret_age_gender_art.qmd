---
title: "Rethinking Pilot Retention in the United States: An Analysis of Key Factors"
shorttitle: "Airline Pilot Retention Factors"
author:
  - name: Michael J. Hickey
    affiliations:
      - name: University of North Dakota
    email: michael.j.hickey@und.edu
    corresponding: true
format:
  apaquarto-docx: default
  apaquarto-html: default
params:
  data_file: "data/processed/retention.csv"
---

# Abstract

This thesis examined pilot retention challenges in U.S. regional airlines, focusing on nonfinancial incentives such as quality of life, career stability, and work-life balance, which may have a greater influence on retention than traditional financial incentives. This quantitative, survey-based approach assesses how pilots rank the factors that influence their retention. Using a sample of U.S.-based pilots, the study examines six key areas adapted from a European pilot retention framework. Statistical analyses, including the Friedman test, the Mann-Whitney U test, and the Kruskal-Wallis test, identified correlations between demographic variables and retention priorities.

The inherent financial constraints of regional airline business models often mean that offered salaries cannot compete with the compensation packages provided by mainline carriers. However, the findings suggest that nonfinancial quality of life factors, such as desirable pilot bases, work-life balance, and predictable schedules, may counterbalance the financial incentives offered by mainline carriers, especially for the younger generation of pilots entering the workforce. Addressing the methodological limitations identified within the study and conducting comprehensive mixed-methods research in the future, will further clarify pilot retention dynamics, offering practical guidance to airline management, policymakers, and labor organizations.

# Introduction

Regional airlines and low-cost carriers face pilot retention issues due to unprecedented hiring rates at mainline and legacy airlines, such as Delta, American, and United (US GAO, 2023). The Regional Airline Association 2022 Annual Report stated that the retention of qualified Pilots-in-Command (PICs) is one of the top concerns in the industry. Several sources have indicated that over 500 regional airline aircraft were parked in 2022 due to PIC retention, resulting in degraded service to numerous smaller markets throughout the United States (Regional Airline Association, 2023; Skores, 2023). Despite short-term relief from hiring rates at the mainline carriers in 2024, forecasts have reaffirmed that there will be a substantial demand for airline pilots over the next decade, which will continue to stress the current pool of qualified pilots.

The foundational work by Efthymiou et al. (2021) on pilot retention at Ryanair (a Low-Cost Carrier in Europe) provided an analytical framework that may be tailored to the U.S. aviation market. Their study employed a mixed-methods approach, providing insights into retention factors such as quality of life (QOL), career progression, and compensation. Other studies conducted in Asia found that robust compensation packages, supportive organizational cultures, and career growth opportunities were common themes to counter competitive hiring practices and enhance pilots' QOL (Amornpipat, 2019; Shanker, 2019). In Australia, Lambeth et al. (2022) explored structural shifts in pilot compensation trends, finding that productivity-based pay and seniority-based scheduling systems positively impacted pilots' decisions to stay, particularly within a highly unionized workforce. Together, these studies outline the known factors influencing pilot retention globally.

Despite insights from international studies, research on pilot retention in the United States remains limited. Additionally, many recent studies primarily focus on the effects of the COVID-19 pandemic (Kim & Choi, 2024; Kioulepoglou & Blundell, 2022; Mizzi et al., 2022; Sobieralski, 2020; Vulturius et al., 2024). Although voluminous research exists on general employee turnover and retention across various business sectors, few directly address U.S. regional airlines. Regional airlines operate low-cost business models that may not allocate the financial resources to offer lucrative compensation packages compared to the mainline airlines, limiting their ability to compete for talent solely on monetary terms (Higgins et al., 2016; Lutte, 2018).

While the analytical and quantitative model for this thesis was executed at an LCC in Europe, a gap exists in understanding if regional airlines in the United States can leverage nonfinancial retention factors, such as culture, QOL, and work-life balance, to competitively retain pilots (Efthymiou et al., 2021). Although similarities in attitudes and perceptions exist between employee groups from varying cultures, Zhang et al. (2012) demonstrated that there are significant cultural differences in retention factors and their order of importance in decisions to stay or leave an employer. This project aims to address the gap by providing a quantitative analysis of pilot retention in the U.S. through the lens of employee motivation and job embeddedness theory, considering both financial and nonfinancial aspects of pilot retention (Burrows et al., 2022; Mitchell et al., 2001; Porter et al., 2019). This examination considers six key areas adapted from a European pilot retention framework using a sample of U.S.-based airline transport pilots. The data collection has been conducted using a quantitative survey to inquire how pilots rank retention factors in order of importance. Statistical analyses, including the Friedman Test, Mann-Whitney U, and Kruskal-Wallis, identified differences between demographic variables and retention priorities, providing empirical insights into pilot career choices.

This analysis builds upon previous research by emphasizing the importance of nonfinancial retention factors for various pilot subgroups. The practical implications of this work are to offer insights that will help airline management, unions, and policymakers craft effective retention strategies that focus on nonfinancial incentives, rather than relying solely on wage increases, which may become financially impractical for regional airline business models.

## Analytical Framework

Efthymiou et al.'s (2021) study on pilot retention provides a methodological foundation for exploring the factors influencing pilot retention within the airline industry. Their exploratory mixed-methods approach, which utilized both qualitative interviews and a quantitative survey, identified key drivers of retention, including being based at home, predictable rosters, competitive salaries, and job security. This research demonstrated how these factors shape pilots' decisions to stay or leave their employer, and it has provided valuable insights into retention strategies for low-cost carriers. However, research suggests that employee perceptions and attitudes toward retention vary significantly across cultural contexts (Majumdarr & Dasgupta, 2024; Zhang et al., 2012). While Efthymiou et al. focused on a European airline, applying their findings to the U.S. market requires adaptations to account for differing use of terms to describe the factors of pilot retention. A deeper discussion of the adaptations is presented in Chapter 2.

## Research Questions (RQs)

This study aims to answer the following research questions:

1. What retention elements do pilots perceive as most important at low-cost carriers and regional airlines in the United States?

2. To what extent do perceived retention elements differ among pilots based on demographic factors (age, gender, position, experience, and military background)?

   a. To what extent do retention elements differ based on pilots' age?

   b. To what extent do retention elements differ between male and female pilots?

   c. To what extent do retention elements differ between Captains and First Officers?

   d. To what extent do retention elements differ based on pilots' years of experience?

   e. To what extent do retention elements differ between pilots with and without military backgrounds?

# Method

The purpose of this study is to explore the factors that influence airline pilot retention in the United States and determine how age, gender, experience, position, and military background influence these retention factors.

## Research Design

This study employs a quantitative cross-sectional design that collects rank-ordered data on the factors most important to airline pilots in the United States when deciding whether to remain with an airline. Given the lack of recent research on airline pilot retention in the United States, a survey instrument that was utilized in a previous European study was deployed (Efthymiou et al., 2021). The lead researcher, Professor Marina Efthymiou, provided the instrument utilized in that study. The survey was revised to incorporate language familiar to the U.S. aviation sector. The final survey instrument underwent several revisions following a review by a team of subject matter experts in pilot retention. Since this survey method had been successfully used in a prior peer-reviewed article, it was concluded that conducting a pilot survey test would be neither necessary nor feasible due to the extra time and Institutional Review Board approvals required.

The survey collected demographic information and employed the analytical framework outlined in the literature review of the European study conducted at Ryanair (Efthymiou et al., 2021b). The demographic factors of age, gender, commercial flying experience, position, and military background were selected as the independent variables in the statistical analysis. Age, position, and flying experience were chosen based on previous findings indicating that airline pilots prioritize different retention factors at various stages of their careers (Lambeth et al., 2022; Nikle & Bjerke, 2018; Shanker, 2019). Gender and military background were included to evaluate whether these variables significantly influence retention factors.

The dependent variable constructs included Financial, Lifestyle, Professional Opportunity, Recognition, Schedule, and Operational Experience aspects of retention. The dependent variables were chosen based on the study by Ethymiou et al. (2021) and refined with the input of subject matter experts on pilot retention. The survey instrument is available in the appendix.

The Mann-Whitney U and Kruskal Wallis tests were conducted to determine whether there were statistically significant differences between demographic subgroups' ranking of retention factors. Nonparametric tests were selected due to the reliance on ranked ordered data in the dependent variables (Frey, 2016). Multiple iterations of the Mann-Whitney U and Kruskal-Wallis tests were applied using the R Studio (version 2024.12.1 Build 563) statistical software. The complete statistical reporting of the tests is available in the appendix.

## Participants

This study targeted participants currently employed as airline transport or commercial pilots with certificated air carriers in the United States. Participants who did not finish the survey were excluded from the analysis. The survey gathered 113 responses; however, only 76 responses were included in the study (*n* = 76). Only 78 participants completed the survey to the end, and two were further excluded because they were not currently employed as pilots by a U.S. air carrier. The participation rate will be further discussed in the limitations.

Demographic items included gender, age, years of experience, total flying hours, air carrier type, flight deck position, military experience, and nationality. Age was grouped into "35 and Under" and "Over 35" due to the limited number of data points from older participants. Nationality was grouped into "U.S. Pilot" and "Foreign Pilot" due to the limited data points available for each foreign nationality. The largest demographic group was American males under 35, regional first officers without prior military experience.

As regional airlines and low-cost carriers face more challenges with retention than mainline/legacy airlines, the study could have excluded other types of carriers. However, due to the low survey participant rate, it was decided to include all types of carriers, despite the potential for outliers.

This study used convenience and snowball sampling methods to recruit participants. The Qualtrics survey link was posted to social media groups of current and former regional airline pilots and sent to the author's personal and professional networks of pilots via text messages and email. The posts and messages requested that participants share the survey link with other pilots. This method was selected because it was easier and less expensive than other sampling methods. Additionally, attempting to gain access to a single pilot group at a single airline posed numerous legal, management, and labor organization approvals that did not meet the timelines for completing this project.

## Survey Instrument and Data Collection

The survey instrument used in this study was based on a previously validated instrument developed by Efthymiou et al. (2021) to examine pilot retention factors at Ryanair, a European low-cost carrier. With permission from the original author, the instrument was adapted to reflect the terminology, structure, and operational context of the United States airline industry. The survey retained the core framework of rank-ordering retention categories—such as schedule, financial, and lifestyle factors—but was revised to align with U.S. labor contract structures, crew scheduling practices, and other cultural differences.

To ensure content and face validity, a panel of four subject matter experts (SMEs) with deep experience in aviation employment and airline pilot retention collaboratively revised and approved the survey. The panel included Dr. Marina Efthymiou (lead author of the original Ryanair study), Dr. Jim Higgins (a U.S. airline labor researcher and professor at the University of North Dakota), and Embry-Riddle Aeronautical University professors Dr. Aman Gupta and Dr. Robert Walton, who specialize in aviation workforce research and survey design. These experts reviewed the instrument for clarity, relevance, and completeness, ensuring that the categories accurately represented the spectrum of retention considerations faced by U.S. airline pilots. A series of five meetings was conducted over Zoom over several months from October 2024 to March 2025 to improve the survey instrument iteratively.

The final instrument included demographic questions (age, gender, position, years of experience, military background), and rank-order questions across six key retention domains: Financial, Schedule, Operational, Lifestyle, Professional Opportunity, and Recognition. Within each domain, participants ranked subelements in order of importance (e.g., fixed schedule, vacation bidding, bid system under "Schedule").

The survey was administered, and responses were collected using Qualtrics, a secure online platform provided by the University of North Dakota at no cost to students. A snowball sampling method was used to reach a broad range of U.S. airline pilots. The survey link was disseminated via social media platforms, including Facebook, LinkedIn, and Reddit, through posts in aviation-focused groups. In addition, the research team shared the survey link via email and text message with contacts in their personal and professional networks, requesting participation and further distribution. This approach allowed the study to reach pilots across various airline types, positions, and experience levels while accommodating the decentralized nature of the U.S. airline pilot workforce. Participation was entirely voluntary, anonymous, and designed to take fewer than 15 minutes to complete.

## Reliability

This study did not employ scale-based reliability measures such as Cronbach's Alpha, as the survey design used a rank-order format rather than Likert-type scales. Since each retention domain captured distinct, nonoverlapping constructs (e.g., financial vs. lifestyle considerations), internal consistency metrics were not appropriate. Despite the lack of formal reliability measures, the instrument was modeled after a peer-reviewed, previously published design that demonstrated success in a similar population (Efthymiou et al., 2021). Although a formal pilot survey was not conducted due to time and IRB constraints, the iterative revision process involving four subject matter experts (SMEs) ensured that the survey items were unambiguous and understandable to the target population.

## Institutional Review Board (IRB)

In March 2025, the study received approval from the University of North Dakota IRB. Further approvals were secured from Dublin City University and Embry-Riddle Aeronautical University in March 2025 so the dataset may be used for future article development and publishing with the panel of experts mentioned above.

Participants accessed the survey via a link from social media, email, or one of the other participants via the snowball method. The link was placed in several Facebook groups with members who were current or former regional airline pilots. Additionally, the link was posted on LinkedIn as a general post from each of the subject matter experts who assisted with the survey development. Several participants were contacted directly via email and direct messaging from the author's professional network.

Upon clicking the link, participants were notified of the study's purpose, data confidentiality measures, and the investigative team's contact information. Participants were then asked for informed consent to participate in the research. The informed consent document is contained in the Appendix. No personally identifiable information was collected from participants. Further measures were taken during statistical analysis to view demographic data collectively (not individually) to safeguard participants' identities further. Questions were designed to be clear, readable, noncoercive, and did not include sensitive or triggering issues.

## Timeline

The concept for this study was developed from June 2024 to December 2024 with the assistance of the research team named above. The survey instrument was developed from October 2024 to March 2025. Survey data was collected between April 1 and May 15, 2025.

```{r setup, include=FALSE}

## Packages
library(tidyverse)
library(usethis)
library(gmodels)
library(FSA)
library(PMCMRplus)
library(DescTools)
library(ggplot2)
library(dplyr)
library(readr)
library(janitor)
library(here)
library(rstatix)
library(knitr)
library(stringr)

knitr::opts_chunk$set(echo = FALSE)

```

## Data work

```{r load-data}
raw <- read_csv(
  here(params$data_file),            # data/retention.csv
  show_col_types = FALSE
)

# Row 1 = headers; rows 2‑3 are survey text & metadata → drop them
retention_data <- raw %>%
  slice(-(1:2)) %>%                 # remove rows 2 & 3
  clean_names()                     # snake_case headers

# Remove unwanted metadata columns
ignore_cols <- c(
  "start_date", "end_date", "status", "progress", "duration_in_seconds",
  "recorded_date", "response_id", "distribution_channel",
  "user_language", "q_recaptcha_score"
)
retention_data <- retention_data %>% select(-all_of(ignore_cols))

```

```{r filter-and-count}
total_records <- nrow(retention_data)

cleaned <- retention_data %>%
  mutate(
    finished         = toupper(as.character(finished)),
    informed_consent = toupper(as.character(informed_consent)),
    screener         = toupper(as.character(screener))
  ) %>%
  mutate(
    exclusion_reason = case_when(
      informed_consent != "YES" ~ "did_not_consent",
      finished         != "TRUE" ~ "did_not_finish",
      screener         != "YES" ~ "not_air_carrier",
      TRUE                     ~ "included"
    )
  )

exclusion_table <- cleaned %>%
  count(exclusion_reason, name = "n")

knitr::kable(exclusion_table,
             col.names = c("Exclusion Reason", "N"),
             caption = "Why Records Were Excluded")

included_data <- cleaned %>%
  filter(exclusion_reason == "included") %>%
  select(-exclusion_reason)         # drop helper column

cat("**Total records in file:**", total_records,
    "\\n\\n**Records kept for analysis:**", nrow(included_data),
    "\\n\\n**Records excluded:**", total_records - nrow(included_data))
```

# Results

The survey aimed to assess the relative importance of various factors pilots consider when deciding whether to stay with or leave an airline. Participants provided demographic information and ranked the six retention constructs from 1 to 6 based on importance. Nonparametric statistical tests were used for analysis because the dependent variables are ranked data (Friedman, 1937; Okoye & Hosseini, 2024). Additionally, since the collected data are not normally distributed, the assumptions of parametric tests are violated, which necessitates the use of nonparametric tests (Frey, 2016).

## Descriptives

```{r age-descriptives}
library(DescTools)   # for Skew() and Kurt()

# ---- 1. make sure age is numeric ---------------------------------------
included_data <- included_data %>%
  mutate(age = as.numeric(age))

# ---- 2. summary table ---------------------------------------------------
age_summary <- included_data %>%
  summarise(
    n           = sum(!is.na(age)),
    min_age     = min(age, na.rm = TRUE),
    q1_age      = quantile(age, 0.25, na.rm = TRUE),
    median_age  = median(age, na.rm = TRUE),
    mean_age    = mean(age, na.rm = TRUE),
    q3_age      = quantile(age, 0.75, na.rm = TRUE),
    max_age     = max(age, na.rm = TRUE),
    sd_age      = sd(age, na.rm = TRUE),
    iqr_age     = IQR(age, na.rm = TRUE),
    skew_age    = Skew(age, na.rm = TRUE),
    kurt_age    = Kurt(age, na.rm = TRUE)
  )

knitr::kable(age_summary, digits = 2,
             col.names = c("N", "Min", "Q1", "Median", "Mean", "Q3", "Max", "SD", "IQR", "Skew", "Kurtosis"),
             caption = "Descriptive Statistics for Age")

# ---- 3. normality test --------------------------------------------------
if (age_summary$n <= 5000) {
  shapiro_p <- shapiro.test(included_data$age)$p.value
  cat("\nShapiro–Wilk normality test p‑value:", round(shapiro_p, 4), "\n")
}

# ---- 4. histogram + density --------------------------------------------
ggplot(included_data, aes(x = age)) +
  geom_histogram(aes(y = after_stat(density)), bins = 15,
                 fill = "steelblue", alpha = 0.6) +
  geom_density(color = "red", linewidth = 1) +
  labs(title = "Age Distribution",
       x = "Age (years)", y = "Density") +
  theme_minimal()

# ---- 5. box‑plot for outliers ------------------------------------------
ggplot(included_data, aes(y = age)) +
  geom_boxplot(fill = "orange", width = 0.25) +
  labs(title = "Age Box‑Plot", y = "Age (years)") +
  theme_minimal()
```

```{r gender-descriptives}
library(janitor)   # tabyl + adorn

# 1 Frequency table with counts & percentages -----------------------------
gender_table <- included_data %>%
  tabyl(gender) %>%              # counts
  adorn_totals("row") %>%        # add Total row
  adorn_pct_formatting(digits = 1)  # add percent column

knitr::kable(gender_table,
             col.names = c("Gender", "N", "Percent"),
             caption = "Gender Distribution")

# 2 Count of missing responses -------------------------------------------
missing_gender <- sum(is.na(included_data$gender) | included_data$gender == "")
cat("\nMissing / blank gender responses:", missing_gender, "\n")

# 3 Bar chart -------------------------------------------------------------
ggplot(included_data, aes(x = gender)) +
  geom_bar(fill = "steelblue") +
  labs(title = "Gender Distribution", x = "Gender", y = "Count") +
  theme_minimal()
```

## General Rank Analysis

```{r RQ1-general-rank-analysis}

# map data columns to factor names
included_data <- included_data %>%
  rename(
    financial_rank    = general_1,
    lifestyle_rank    = general_2,
    professional_rank = general_3,
    recognition_rank  = general_4,
    schedule_rank     = general_5,
    operational_rank  = general_6
  )

rank_cols <- included_data %>%
  select(ends_with("_rank")) %>%
  names()

# ---- 1. build participant ID + tidy long --------------------------------
general_long <- included_data %>%
  mutate(pid = row_number()) %>%            # unique ID per pilot
  select(pid, all_of(rank_cols)) %>%
  pivot_longer(cols = all_of(rank_cols),
               names_to  = "factor",
               values_to = "rank") %>%
  mutate(
    factor = str_remove(factor, "_rank$"),
    rank   = as.numeric(rank)               # ensure numeric for calculations
  )

# ---- 2. Table 1: median & IQR ------------------------------------------
rank_summary <- general_long %>%
  group_by(factor) %>%
  summarise(
    n      = n(),
    median = median(rank, na.rm = TRUE),
    iqr    = IQR(rank, na.rm = TRUE)
  ) %>%
  arrange(median)

knitr::kable(rank_summary,
             col.names = c("Factor", "N", "Median", "IQR"),
             caption = "Table 1\nRank Summary for General Retention Factors",
             digits = 1)

# ---- 3. Table 2: count of rank = 1 -------------------------------------
top_factor_tbl <- general_long %>%
  filter(rank == 1) %>%
  count(factor, name = "n") %>%
  mutate(percent = n / sum(n) * 100) %>%
  arrange(desc(n))

knitr::kable(top_factor_tbl,
             col.names = c("Factor", "N", "Percent"),
             digits = 1,
             caption = "Table 2\nNumber (and %) of Pilots Ranking Each Factor #1")

# ---- 4. Bar chart -------------------------------------------------------
ggplot(top_factor_tbl, aes(x = reorder(factor, -n), y = n)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  labs(title = "Figure 1\nMost Important Retention Factor",
       x = "Factor Ranked #1", y = "Number of Pilots") +
  theme_minimal()

# ---- 5. Friedman test ---------------------------------------------------
library(rstatix)
friedman_res <- general_long %>%
  friedman_test(rank ~ factor | pid)

print(friedman_res)
```

```{r RQ1-posthoc-pairwise}

pairwise_tbl <- general_long %>%
  mutate(rank = as.numeric(rank)) %>%          # <‑‑ convert here
  pairwise_wilcox_test(
    rank ~ factor,
    paired = TRUE,
    p.adjust.method = "bonferroni"
  ) %>%
  mutate(
    comparison = str_c(group1, " vs ", group2),
    p.adj      = round(p.adj, 3),
    p.sig      = if_else(p.adj < .001, "< .001", as.character(p.adj))
    # effect size optional; removed for simplicity
  ) %>%
  select(comparison, p.sig)

knitr::kable(pairwise_tbl,
             col.names = c("Comparison", "p (adjusted)"),
             caption = "Table 3\nPairwise Wilcoxon Tests Between General Factors\n(Bonferroni‑adjusted p‑values)")
```

## Age Analysis

```{r RQ2a-age-groups}

# 1 ── create age‑group (<=35 vs >35) ------------------------------------
included_data <- included_data %>%
  mutate(age_group = if_else(age <= 35, "≤ 35", "> 35"))

# 2 ── gather ranks to long format (reuse earlier rank_cols) -------------
general_age_long <- included_data %>%
  select(age_group, all_of(rank_cols)) %>%
  pivot_longer(cols = all_of(rank_cols),
               names_to = "factor",
               values_to = "rank") %>%
  mutate(
    factor = str_remove(factor, "_rank$"),
    rank   = as.numeric(rank)        # ensure numeric
  )

# 3 ── summary table: medians by group -----------------------------------
age_medians <- general_age_long %>%
  group_by(factor, age_group) %>%
  summarise(
    n      = n(),
    median = median(rank, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  pivot_wider(
    names_from  = age_group,
    values_from = c(n, median),
    names_glue  = "{age_group}_{.value}"
  ) %>%
  # reorder columns so ≤ 35 comes first
  select(factor,
         `≤ 35_n`, `≤ 35_median`,
         `> 35_n`, `> 35_median`)

# 4 ── Mann‑Whitney tests per factor -------------------------------------
mw_tbl <- general_age_long %>%
  group_by(factor) %>%
  wilcox_test(rank ~ age_group, exact = FALSE) %>%  # asymptotic; >30 per group
  mutate(p_adj = p.adjust(p, method = "bonferroni")) %>%
  select(factor, p_adj)

# 5 ── merge medians + p-values ------------------------------------------
results_tbl <- age_medians %>%
  left_join(mw_tbl, by = "factor") %>%
  arrange(p_adj)

knitr::kable(results_tbl,
             digits = 2,
             col.names = c("Factor",
                           "N (≤35)", "Median (≤35)",
                           "N (>35)", "Median (>35)",
                           "p (adjusted)"),
             caption = "Table 4\nMann‑Whitney U Tests: Age Groups (≤ 35 vs > 35) on General‑Factor Ranks")
```

## Gender Analysis

```{r RQ2c-gender-clean}
library(dplyr); library(tidyr); library(rstatix); library(stringr); library(knitr)

# ── 1. robust gender cleaning ────────────────────────────────────────────
included_data <- included_data %>%
  mutate(
    gender_raw = trimws(gender),            # keep original if you like
    gender = case_when(
      str_starts(tolower(gender_raw), "m")                ~ "Male",
      str_starts(tolower(gender_raw), "f")                ~ "Female",
      str_detect(tolower(gender_raw), "non|other")        ~ "Other",
      TRUE                                                ~ NA_character_
    )
  )

# counts for transparency
cat("Gender counts:\n")
print(table(included_data$gender, useNA = "ifany"))  # should be 67/8/1

# ── 2. prepare long rank data ────────────────────────────────────────────
general_gender_long <- included_data %>%
  select(gender, all_of(rank_cols)) %>%
  pivot_longer(cols = all_of(rank_cols),
               names_to = "factor",
               values_to = "rank") %>%
  mutate(
    factor = str_remove(factor, "_rank$"),
    rank   = as.numeric(rank)
  ) %>%
  filter(gender %in% c("Male", "Female"))   # exclude "Other" if n < 5

# ── 3. Table 5: medians by gender ────────────────────────────────────────
gender_medians <- general_gender_long %>%
  group_by(factor, gender) %>%
  summarise(
    n      = n(),
    median = median(rank, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  pivot_wider(
    names_from  = gender,
    values_from = c(n, median),
    names_glue  = "{gender}_{.value}"
  )

knitr::kable(gender_medians,
             col.names = c("Factor", "N (Female)", "N (Male)", "Median (Female)", "Median (Male)"),
             digits = 1,
             caption = "Table 5\nMedian Rank of General Factors by Gender")

# ── 4. Mann‑Whitney U tests (Male vs Female) ─────────────────────────────
gender_counts <- table(included_data$gender)
if(all(c("Male", "Female") %in% names(gender_counts)) &&
   all(gender_counts[c("Male", "Female")] >= 5)) {

  mw_gender <- general_gender_long %>%
    group_by(factor) %>%
    wilcox_test(rank ~ gender, exact = FALSE) %>%
    mutate(p_adj = p.adjust(p, method = "bonferroni")) %>%
    select(factor, p_adj)

  knitr::kable(mw_gender,
               col.names = c("Factor", "p (adjusted)"),
               digits = 3,
               caption = "Table 6\nMann‑Whitney U Tests: Male vs Female (Bonferroni‑adjusted p)")
} else {
  cat("\nMann‑Whitney tests skipped: fewer than 5 cases in one gender group.\n")
}
```